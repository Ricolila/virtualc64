\doxysection{Thread model}
\hypertarget{group___thread_model}{}\label{group___thread_model}\index{Thread model@{Thread model}}
\hypertarget{group___thread_model_autotoc_md1}{}\doxysubsection{\texorpdfstring{Thread model}{Thread model}}\label{group___thread_model_autotoc_md1}
This class manages the emulator thread that runs side by side with the GUI. The thread exists during the lifetime of the emulator, but may not run the emulator all the time. The exact behavior is controlled by the internal state.

The following states are distinguished\+:


\begin{DoxyItemize}
\item {\bfseries{Off\+:}} The emulator is turned off
\item {\bfseries{Paused\+:}} The emulator is turned on but not running
\item {\bfseries{Running\+:}} The emulator is turned on and running
\item {\bfseries{Suspended\+:}} The emulator is paused for a short period of time
\item {\bfseries{Halted\+:}} The emulator is shutting down
\end{DoxyItemize}




\begin{DoxyItemize}
\item When an instance of the Thread class is created, a new thread is started
\item which executes the thread\textquotesingle{}s run\+Loop() function. This function executes
\item a loop which periodically calls function execute(). After each iteration,
\item the thread is put to sleep to synchronize timing.
\item 
\item Suspend / Resume\+:
\item 
\item The Thread class provides a suspend-\/resume mechanism for pausing the thread
\item temporarily. This functionality is utilized frequently by the GUI to carry
\item out atomic operations that cannot be performed while the emulator is running.
\item To pause the emulator temporarily, the critical code section can be embedded
\item in a suspend/resume block like this\+:
\item {\ttfamily }
\item {\ttfamily  suspend();}
\item {\ttfamily  // Modify the internal state}
\item {\ttfamily  resume(); \texorpdfstring{$\ast$}{*}}
\item It it safe to nest multiple suspend/resume blocks, but it is essential
\item that each call to suspend() is followed by a call to resume(). As a result,
\item the critical code section must not be exited in the middle, e.\+g., by
\item throwing an exception. It is therefore recommended to use the SUSPENDED
\item macro which is exit-\/safe. It is used in the following way\+:
\item 
\item \{ SUSPENDED
\item 
\item Do something with the internal state;
\item return or throw an exceptions as you like;
\item \}
\item 
\item Synchronization\+:
\item 
\item The Thread class is responsible for timing synchronization. I.\+e., it has to
\item ensure that the proper amount of frames are executed per second. To
\item synchronize timing, the thread waits for an external wake-\/up signal. When
\item the wake-\/up signal comes in (by calling wakeup()), the thread computes the
\item computes computes all missing frames. If the number of missing frames
\item exceeds a threshold, the thread resynchronizes itself by calling resync().
\item 
\item Warp mode\+:
\item 
\item To speed up emulation (e.\+g., during disk accesses), the emulator may be put
\item into warp mode. In this mode, timing synchronization is disabled causing the
\item emulator to run as fast as possible.
\item 
\item Similar to warp mode, the emulator may be put into track mode. This mode is
\item enabled when the GUI debugger is opend and disabled when the debugger is
\item closed. In track mode, several time-\/consuming tasks are performed that are
\item usually left out. E.\+g., the CPU tracks all executed instructions and stores
\item the recorded information in a trace buffer. 
\end{DoxyItemize}