\doxysection{VICII.\+h}
\hypertarget{_v_i_c_i_i_8h_source}{}\label{_v_i_c_i_i_8h_source}\index{/Users/hoff/Retro/virtualc64/Emulator/Components/VICII/VICII.h@{/Users/hoff/Retro/virtualc64/Emulator/Components/VICII/VICII.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ VirtualC64}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ Dirk\ W.\ Hoffmann.\ www.dirkwhoffmann.de}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ This\ FILE\ is\ dual-\/licensed.\ You\ are\ free\ to\ choose\ between:}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ \ \ \ \ -\/\ The\ GNU\ General\ Public\ License\ v3\ (or\ any\ later\ version)}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ \ \ \ \ -\/\ The\ Mozilla\ Public\ License\ v2}}
\DoxyCodeLine{00009\ \textcolor{comment}{//}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ SPDX-\/License-\/Identifier:\ GPL-\/3.0-\/or-\/later\ OR\ MPL-\/2.0}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_v_i_c_i_i_types_8h}{VICIITypes.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}SubComponent.h"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}Colors.h"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}Constants.h"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}DmaDebugger.h"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}MemoryTypes.h"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}TimeDelayed.h"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{namespace\ }vc64\ \{}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{class\ }VICII\ final\ :\ \textcolor{keyword}{public}\ SubComponent,\ \textcolor{keyword}{public}\ Inspectable<VICIIInfo,\ VICIIStats>\ \{}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }C64Memory;}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }DmaDebugger;}
\DoxyCodeLine{00029\ \ \ \ \ }
\DoxyCodeLine{00030\ \ \ \ \ ConfigOptions\ options\ =\ \{}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8a097615e0e27fb679e172516082f1a5b6}{OPT\_VICII\_REVISION}},}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8a23eefd98a66a2b07edc91b23845d3840}{OPT\_VICII\_POWER\_SAVE}},}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8a46240f17f79a3417e32ca8452fcd7bd8}{OPT\_VICII\_PALETTE}},}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8a8f39c8992c8dacc1fa43e2bcff8e0f5a}{OPT\_VICII\_BRIGHTNESS}},}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8a2cb14dcc324ff1e69aaf8a02363fb7ba}{OPT\_VICII\_CONTRAST}},}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8a5ea679a8076a9bbc9834f895726d8678}{OPT\_VICII\_SATURATION}},}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8adef705eaa36b3e7cac49606c570b0382}{OPT\_VICII\_GRAY\_DOT\_BUG}},}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8ad48d89cb754f50ac322db496a3d19f88}{OPT\_GLUE\_LOGIC}},}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8ad749dedb1ec78b680c7aa47ebfe4010f}{OPT\_VICII\_HIDE\_SPRITES}},}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8adb90bd2fb3bf6ff4edc7d871df89d9f6}{OPT\_VICII\_SS\_COLLISIONS}},}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8ac736d8d310e7664e00280c20768b8602}{OPT\_VICII\_SB\_COLLISIONS}}}
\DoxyCodeLine{00043\ \ \ \ \ \};}
\DoxyCodeLine{00044\ \ \ \ \ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{//\ Current\ configuration}}
\DoxyCodeLine{00046\ \ \ \ \ VICIIConfig\ config\ =\ \{\ \};}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ Result\ of\ the\ latest\ inspection}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ mutable\ VICIIInfo\ info\ =\ \{\ \};}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{mutable}\ SpriteInfo\ spriteInfo[8]\ =\ \{\ \};}
\DoxyCodeLine{00051\ \ \ \ \ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{//\ Statistics}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ VICIIStats\ stats\ =\ \{\ \};}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//\ Chip\ properties\ (derived\ from\ config.revision)}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{bool}\ isPAL;}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{bool}\ isNTSC;}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{bool}\ is856x;}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{bool}\ is656x;}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00062\ \ \ \ \ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{comment}{//\ Sub\ components}}
\DoxyCodeLine{00064\ \ \ \ \ DmaDebugger\ dmaDebugger;}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{/*\ The\ VICII\ function\ table.\ Each\ entry\ in\ this\ table\ is\ a\ pointer\ to\ a}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ \ \ \ \ *\ VICII\ method\ executed\ in\ a\ certain\ scanline\ cycle:}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ \ \ \ \ *\ \ \ functable[model][flags][cycle]}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00071\ \textcolor{comment}{\ \ \ \ \ *\ \ \ model:\ VICII\ revision}}
\DoxyCodeLine{00072\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00073\ \textcolor{comment}{\ \ \ \ \ *\ \ \ flags:\ One\ or\ more\ of\ the\ following:}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00075\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ CYCLE\_PAL\ \ \ \ \ \ \ :\ Emulates\ a\ PAL\ cycle,\ NTSC\ otherwise}}
\DoxyCodeLine{00076\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ CYCLE\_DMA\ \ \ \ \ \ \ :\ Runs\ the\ DMA\ debugger\ code\ for\ the\ specific\ cycle}}
\DoxyCodeLine{00077\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ CYLCE\_HEADLESS\ \ :\ Skips\ all\ pixel-\/drawing\ related\ code}}
\DoxyCodeLine{00078\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00079\ \textcolor{comment}{\ \ \ \ \ *\ \ \ cycle:\ 1\ ..\ 65\ (cycle\ 0\ is\ a\ stub\ and\ never\ called)}}
\DoxyCodeLine{00080\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00081\ \textcolor{comment}{\ \ \ \ \ *\ \ \ CYCLE\_DMA\ and\ CYCLE\_HEADLESS\ must\ be\ be\ set\ simultaneously\ as\ this}}
\DoxyCodeLine{00082\ \textcolor{comment}{\ \ \ \ \ *\ \ \ combination\ does\ not\ make\ sense.}}
\DoxyCodeLine{00083\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{typedef}\ void\ (VICII::*ViciiFunc)(void);}
\DoxyCodeLine{00085\ \ \ \ \ ViciiFunc\ functable[6][8][66]\ =\ \{\ \};}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{comment}{//\ Function\ pointers\ currently\ in\ use}}
\DoxyCodeLine{00088\ \ \ \ \ ViciiFunc\ vicfunc[66];}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{comment}{//\ I/O\ space\ (CPU\ accessible)}}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00094\ \ \ \ \ }
\DoxyCodeLine{00095\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00096\ \ \ \ \ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{comment}{/*\ Piped\ I/O\ register\ state.\ When\ an\ I/O\ register\ is\ written\ to,\ the}}
\DoxyCodeLine{00098\ \textcolor{comment}{\ \ \ \ \ *\ corresponding\ value\ in\ variable\ current\ is\ changed\ and\ a\ flag\ is\ set\ in}}
\DoxyCodeLine{00099\ \textcolor{comment}{\ \ \ \ \ *\ variable\ delay.\ Function\ processDelayedActions()\ reads\ the\ flag\ and,\ if}}
\DoxyCodeLine{00100\ \textcolor{comment}{\ \ \ \ \ *\ set\ to\ true,\ updates\ the\ delayed\ values.}}
\DoxyCodeLine{00101\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ VICIIRegisters\ current;}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ VICIIRegisters\ delayed;}
\DoxyCodeLine{00105\ \ \ \ \ \}\ reg;}
\DoxyCodeLine{00106\ \ \ \ \ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{comment}{//\ Raster\ interrupt\ line\ (\$D011:8\ +\ \$D012)}}
\DoxyCodeLine{00108\ \ \ \ \ u16\ rasterIrqLine;}
\DoxyCodeLine{00109\ \ \ \ \ }
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{comment}{//\ Latched\ lightpen\ coordinates\ (\$D013\ and\ \$D014)}}
\DoxyCodeLine{00111\ \ \ \ \ u8\ latchedLPX;}
\DoxyCodeLine{00112\ \ \ \ \ u8\ latchedLPY;}
\DoxyCodeLine{00113\ \ \ \ \ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{comment}{//\ Memory\ address\ register\ (\$D018)}}
\DoxyCodeLine{00115\ \ \ \ \ u8\ memSelect;}
\DoxyCodeLine{00116\ \ \ \ \ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{comment}{//\ Interrupt\ Request\ and\ Mask\ Register\ (\$D019\ and\ \$D01A)}}
\DoxyCodeLine{00118\ \ \ \ \ u8\ irr;}
\DoxyCodeLine{00119\ \ \ \ \ u8\ imr;}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ }
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{comment}{//\ Chip\ internals}}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00125\ \ \ \ \ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{comment}{//\ IRQ\ <-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ (1)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ |Refresh\ counter|\ |\ Interrupt\ logic\ |<-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ +-\/+\ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \string^\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{comment}{//\ \ \ A\ \ \ \ \ |M|\ \ \ \ v\ \ \ \ \ (2),(3)\ \ \ |\ \ \ \ \ \ \ (4),(5)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{comment}{//\ \ \ d\ \ \ \ \ |e|\ \ \ +-\/+\ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ +-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{comment}{//\ \ \ d\ \ \ \ \ |m|\ \ \ |A|\ \ \ \ |Raster\ counter|-\/>|\ VC/RC\ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{//\ \ \ r\ \ \ \ \ |o|\ \ \ |d|\ +-\/>|\ \ \ \ \ \ X/Y\ \ \ \ \ |\ \ +-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{comment}{//\ \ \ .\ <==>|r|\ \ \ |d|\ |\ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{comment}{//\ \ +\ \ \ \ \ \ |y|\ \ \ |r|\ |\ \ \ \ \ |\ |\ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ (6),(7)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{comment}{//\ \ \ d\ \ \ \ \ |\ |\ \ \ |.|<-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ |}}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{comment}{//\ \ \ a\ \ \ \ \ |i|\ \ \ |g|===========================>|40×12\ bit\ video\ matrix-\//|\ |}}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{comment}{//\ \ \ t\ \ \ \ \ |n|<=>|e|\ |\ \ \ \ \ |\ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ color\ line\ \ \ \ \ \ \ |\ |}}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{comment}{//\ \ \ a\ \ \ \ \ |t|\ \ \ |n|\ |\ \ \ \ \ |\ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ |}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ |e|\ \ \ |e|\ |\ \ \ \ \ |\ \ \ |\ (8)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ |r|\ \ \ |r|\ |\ \ \ \ \ |\ \ \ |\ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ \ \ \ ||\ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//\ \ BA\ \ <-\/-\/|f|\ \ \ |a|============>|8×24\ bit\ sprite\ |\ \ \ \ \ \ \ \ \ ||\ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ |a|\ \ \ |t|<-\/-\/-\/-\/+\ |\ \ \ |\ |\ \ data\ buffers\ \ |\ \ \ \ \ \ \ \ \ ||\ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{comment}{//\ \ AEC\ <-\/-\/|c|\ \ \ |o|\ |\ \ \ |\ v\ \ \ |\ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ \ \ \ ||\ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ |e|\ \ \ |r|\ |\ +-\/-\/-\/-\/-\/+\ |\ \ \ \ \ \ \ \ \ ||\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ +-\/+\ \ \ +-\/+\ |\ |MC0-\/7|\ |\ \ (10)\ \ \ \(\backslash\)/\ \ \ \ \ \ \ \ \ \ (11)\ \ \ \(\backslash\)/\ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ +-\/-\/-\/-\/-\/+\ |\ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ |}}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ (9)\ |\ \ |\ Sprite\ data\ \ |\ \ \ |Graphics\ data\ |\ \ \ \ \ \ |}}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ |\ \ |\ \ sequencer\ \ \ |\ \ \ |\ \ sequencer\ \ \ |\ \ \ \ \ \ |}}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{comment}{//\ \ RAS\ <-\/-\/|\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ |\ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ |}}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{comment}{//\ \ CAS\ <-\/-\/|Clock\ generator|\ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{comment}{//\ \ ø0\ \ <-\/-\/|\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ v\ \ \ \ \ \ \ \ \ v\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ |\ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \string^\ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ MUX\ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ |\ Sprite\ priorities\ and\ |-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{comment}{//\ \ øIN\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ |\ \ collision\ detection\ \ |}}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ (12)}}
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{comment}{//\ \ \ \ VC:\ Video\ Matrix\ Counter\ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ (14)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ (13)\ \ \ v}}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{comment}{//\ \ \ \ RC:\ Row\ Counter\ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ (15)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/>|\ Border\ unit\ |}}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{comment}{//\ \ \ \ MC:\ MOB\ Data\ Counter\ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ (16)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v}}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |Sync\ generation\ |\ \ |Color\ generation|<-\/-\/-\/-\/-\/-\/-\/\ øCOLOR}}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ |}}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v\ \ \ \ \ \ v}}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Video\ output}}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (S/LUM\ and\ COLOR)\ \ \ \ \ \ \ \ \ \ \ \ \ \ [C.B.]}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ }
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{comment}{/*\ Refresh\ counter\ (1):\ "{}The\ VICII\ does\ five\ read\ accesses\ in\ every\ raster}}
\DoxyCodeLine{00177\ \textcolor{comment}{\ \ \ \ \ *\ line\ for\ the\ refresh\ of\ the\ dynamic\ RAM.\ An\ 8\ bit\ refresh\ counter\ (REF)}}
\DoxyCodeLine{00178\ \textcolor{comment}{\ \ \ \ \ *\ is\ used\ to\ generate\ 256\ DRAM\ row\ addresses.\ The\ counter\ is\ reset\ to\ \$ff}}
\DoxyCodeLine{00179\ \textcolor{comment}{\ \ \ \ \ *\ in\ raster\ line\ 0\ and\ decremented\ by\ 1\ after\ each\ refresh\ access."{}\ [C.B.]}}
\DoxyCodeLine{00180\ \textcolor{comment}{\ \ \ \ \ *\ See\ also:\ rAccess()}}
\DoxyCodeLine{00181\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00182\ \ \ \ \ u8\ refreshCounter;}
\DoxyCodeLine{00183\ \ \ \ \ }
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{comment}{/*\ Raster\ counter\ X\ (2):\ Defines\ the\ sprite\ coordinate\ system.}}
\DoxyCodeLine{00185\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00186\ \ \ \ \ u16\ xCounter;}
\DoxyCodeLine{00187\ \ \ \ \ }
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{comment}{/*\ Y\ raster\ counter\ (3):\ The\ scanline\ counter\ is\ usually\ incremented\ in}}
\DoxyCodeLine{00189\ \textcolor{comment}{\ \ \ \ \ *\ cycle\ 1.\ The\ only\ exception\ is\ the\ overflow\ condition\ which\ is\ handled}}
\DoxyCodeLine{00190\ \textcolor{comment}{\ \ \ \ \ *\ in\ cycle\ 2.}}
\DoxyCodeLine{00191\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00192\ \ \ \ \ u32\ yCounter;}
\DoxyCodeLine{00193\ \ \ \ \ }
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{comment}{/*\ Video\ counter\ (14):\ A\ 10\ bit\ counter\ that\ can\ be\ loaded\ with\ the\ value}}
\DoxyCodeLine{00195\ \textcolor{comment}{\ \ \ \ \ *\ from\ vcBase.}}
\DoxyCodeLine{00196\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00197\ \ \ \ \ u16\ vc;}
\DoxyCodeLine{00198\ \ \ \ \ }
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{comment}{/*\ Video\ counter\ base:\ A\ 10\ bit\ data\ register\ that\ can\ be\ loaded\ with\ the}}
\DoxyCodeLine{00200\ \textcolor{comment}{\ \ \ \ \ *\ value\ from\ vc.}}
\DoxyCodeLine{00201\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00202\ \ \ \ \ u16\ vcBase;}
\DoxyCodeLine{00203\ \ \ \ \ }
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{comment}{/*\ Row\ counter\ (15):\ A\ 3\ bit\ counter\ with\ reset\ input.}}
\DoxyCodeLine{00205\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00206\ \ \ \ \ u8\ rc;}
\DoxyCodeLine{00207\ \ \ \ \ }
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{comment}{/*\ Video\ matrix\ (6):\ Every\ 8th\ scanline,\ the\ VICII\ chips\ performs\ a}}
\DoxyCodeLine{00209\ \textcolor{comment}{\ \ \ \ \ *\ c-\/access\ and\ fills\ this\ array\ with\ character\ information.}}
\DoxyCodeLine{00210\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00211\ \ \ \ \ u8\ videoMatrix[40];}
\DoxyCodeLine{00212\ \ \ \ \ }
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{comment}{/*\ Color\ line\ (7):\ Every\ 8th\ scanline,\ the\ VICII\ chips\ performs\ a}}
\DoxyCodeLine{00214\ \textcolor{comment}{\ \ \ \ \ *\ c-\/access\ and\ fills\ the\ array\ with\ color\ information.}}
\DoxyCodeLine{00215\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00216\ \ \ \ \ u8\ colorLine[40];}
\DoxyCodeLine{00217\ \ \ \ \ }
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{comment}{/*\ Video\ matrix\ line\ index:\ "{}Besides\ this,\ there\ is\ a\ 6\ bit\ counter\ with}}
\DoxyCodeLine{00219\ \textcolor{comment}{\ \ \ \ \ *\ reset\ input\ that\ keeps\ track\ of\ the\ position\ within\ the\ internal\ 40×12}}
\DoxyCodeLine{00220\ \textcolor{comment}{\ \ \ \ \ *\ bit\ video\ matrix/color\ line\ where\ read\ character\ pointers\ are\ stored}}
\DoxyCodeLine{00221\ \textcolor{comment}{\ \ \ \ \ *\ resp.\ read\ again.\ I\ will\ call\ this\ 'VMLI'\ (video\ matrix\ line\ index)}}
\DoxyCodeLine{00222\ \textcolor{comment}{\ \ \ \ \ *\ here."{}\ [C.B.]}}
\DoxyCodeLine{00223\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00224\ \ \ \ \ u8\ vmli;}
\DoxyCodeLine{00225\ \ \ \ \ }
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{comment}{/*\ Graphics\ data\ sequencer\ (10):\ An\ 8\ bit\ shift\ register\ to\ synthesize}}
\DoxyCodeLine{00228\ \textcolor{comment}{\ \ \ \ \ *\ canvas\ pixels.}}
\DoxyCodeLine{00229\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Shift\ register\ data}}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ u8\ data;}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Indicates\ whether\ the\ shift\ register\ can\ load\ data.\ If\ true,\ the}}
\DoxyCodeLine{00236\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ register\ is\ loaded\ when\ the\ current\ x\ scroll\ offset\ matches\ the}}
\DoxyCodeLine{00237\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ current\ pixel\ number.}}
\DoxyCodeLine{00238\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ canLoad;}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Multi-\/color\ synchronization\ flipflop.\ Whenever\ the\ shift\ register\ is}}
\DoxyCodeLine{00242\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ loaded,\ the\ synchronization\ flipflop\ is\ also\ set.\ It\ is\ toggled\ with}}
\DoxyCodeLine{00243\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ each\ pixel\ and\ used\ to\ synchronize\ the\ synthesis\ of\ multi-\/color}}
\DoxyCodeLine{00244\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ pixels.}}
\DoxyCodeLine{00245\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ mcFlop;}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Latched\ character\ info.\ Whenever\ the\ shift\ register\ is\ loaded,\ the}}
\DoxyCodeLine{00249\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ current\ character\ value\ (which\ was\ once\ read\ during\ a\ gAccess)\ is}}
\DoxyCodeLine{00250\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ latched.\ This\ value\ is\ used\ until\ the\ shift\ register\ loads\ again.}}
\DoxyCodeLine{00251\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ u8\ latchedChr;}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Latched\ color\ info.\ Whenever\ the\ shift\ register\ is\ loaded,\ the}}
\DoxyCodeLine{00255\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ current\ color\ value\ (which\ was\ once\ read\ during\ a\ gAccess)\ is}}
\DoxyCodeLine{00256\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ latched.\ This\ value\ is\ used\ until\ the\ shift\ register\ loads\ again.}}
\DoxyCodeLine{00257\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ u8\ latchedCol;}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Color\ bits.\ Every\ second\ pixel\ (as\ synchronized\ with\ mcFlop),\ the}}
\DoxyCodeLine{00261\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ multi-\/color\ bits\ are\ remembered.}}
\DoxyCodeLine{00262\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ u8\ colorbits;}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \ \ \}\ sr;}
\DoxyCodeLine{00266\ \ \ \ \ }
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{comment}{/*\ Sprite\ data\ sequencer\ (11):\ The\ VICII\ chip\ has\ a\ 24\ bit\ (3\ byte)\ shift}}
\DoxyCodeLine{00268\ \textcolor{comment}{\ \ \ \ \ *\ register\ for\ each\ sprite.\ It\ stores\ the\ sprite\ for\ one\ scanline.\ If\ a}}
\DoxyCodeLine{00269\ \textcolor{comment}{\ \ \ \ \ *\ sprite\ is\ a\ display\ candidate\ in\ the\ current\ scanline,\ its\ shift}}
\DoxyCodeLine{00270\ \textcolor{comment}{\ \ \ \ \ *\ register\ is\ activated\ when\ the\ raster\ X\ coordinate\ matches\ the\ sprites}}
\DoxyCodeLine{00271\ \textcolor{comment}{\ \ \ \ \ *\ X\ coordinate.\ The\ comparison\ is\ done\ in\ method\ drawSprite().\ Once\ a}}
\DoxyCodeLine{00272\ \textcolor{comment}{\ \ \ \ \ *\ shift\ register\ is\ activated,\ it\ remains\ activated\ until\ the\ beginning\ of}}
\DoxyCodeLine{00273\ \textcolor{comment}{\ \ \ \ \ *\ the\ next\ scanline.\ However,\ after\ an\ activated\ shift\ register\ has}}
\DoxyCodeLine{00274\ \textcolor{comment}{\ \ \ \ \ *\ dumped\ out\ its\ 24\ pixels,\ it\ can't\ draw\ anything\ else\ than\ transparent}}
\DoxyCodeLine{00275\ \textcolor{comment}{\ \ \ \ \ *\ pixels\ (which\ is\ the\ same\ as\ not\ to\ draw\ anything).\ An\ exception\ is}}
\DoxyCodeLine{00276\ \textcolor{comment}{\ \ \ \ \ *\ during\ DMA\ cycles.\ When\ a\ shift\ register\ is\ activated\ during\ such\ a}}
\DoxyCodeLine{00277\ \textcolor{comment}{\ \ \ \ \ *\ cycle,\ it\ freezes\ a\ short\ period\ of\ time\ in\ which\ it\ repeats\ the}}
\DoxyCodeLine{00278\ \textcolor{comment}{\ \ \ \ \ *\ previous\ drawn\ pixel.}}
\DoxyCodeLine{00279\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00280\ \ \ \ \ SpriteSR\ spriteSr[8];}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{comment}{/*\ Indicates\ for\ each\ sprite\ if\ the\ shift\ register\ is\ active.\ Once\ the}}
\DoxyCodeLine{00283\ \textcolor{comment}{\ \ \ \ \ *\ shift\ register\ is\ started,\ it\ runs\ as\ long\ it\ contains\ at\ least\ one\ '1'}}
\DoxyCodeLine{00284\ \textcolor{comment}{\ \ \ \ \ *\ bit\ (data\ !=\ 0).}}
\DoxyCodeLine{00285\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00286\ \ \ \ \ u8\ spriteSrActive;}
\DoxyCodeLine{00287\ \ \ \ \ }
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{comment}{//\ Sprite-\/sprite\ collision\ register\ (12)}}
\DoxyCodeLine{00289\ \ \ \ \ u8\ spriteSpriteCollision;}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ \ \ \ \ \textcolor{comment}{//\ Sprite-\/background\ collision\ register\ (12)}}
\DoxyCodeLine{00292\ \ \ \ \ u8\ spriteBackgroundColllision;}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ }
\DoxyCodeLine{00295\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00296\ \ \ \ \ \textcolor{comment}{//\ Border\ flipflops}}
\DoxyCodeLine{00297\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00298\ \ \ \ \ }
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{comment}{/*\ Piped\ frame\ flipflops\ state\ (13):\ When\ a\ flipflop\ toggles,\ the\ value\ in}}
\DoxyCodeLine{00300\ \textcolor{comment}{\ \ \ \ \ *\ variable\ 'current'\ is\ changed\ and\ a\ flag\ is\ set\ in\ variable\ 'delay'.}}
\DoxyCodeLine{00301\ \textcolor{comment}{\ \ \ \ \ *\ Function\ processDelayedActions()\ reads\ the\ flag\ and\ if\ set\ to\ true,}}
\DoxyCodeLine{00302\ \textcolor{comment}{\ \ \ \ \ *\ updates\ the\ delayed\ values\ with\ the\ current\ ones.}}
\DoxyCodeLine{00303\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ FrameFlipflops\ current;}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ FrameFlipflops\ delayed;}
\DoxyCodeLine{00307\ \ \ \ \ \}\ flipflops;}
\DoxyCodeLine{00308\ \ \ \ \ }
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{comment}{/*\ Vertical\ frame\ flipflop\ set\ condition.\ Indicates\ whether\ the\ vertical}}
\DoxyCodeLine{00310\ \textcolor{comment}{\ \ \ \ \ *\ frame\ flipflop\ needs\ to\ be\ set\ in\ the\ current\ scanline.}}
\DoxyCodeLine{00311\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{keywordtype}{bool}\ verticalFrameFFsetCond;}
\DoxyCodeLine{00313\ \ \ \ \ }
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{comment}{/*\ First\ coordinate\ where\ the\ main\ frame\ flipflop\ is\ checked.\ Either\ 24\ or}}
\DoxyCodeLine{00315\ \textcolor{comment}{\ \ \ \ \ *\ 31,\ dependend\ on\ the\ CSEL\ bit.}}
\DoxyCodeLine{00316\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00317\ \ \ \ \ u16\ leftComparisonVal;}
\DoxyCodeLine{00318\ \ \ \ \ }
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{comment}{/*\ Second\ coordinate\ where\ the\ main\ frame\ flipflop\ is\ checked.\ Either\ 344}}
\DoxyCodeLine{00320\ \textcolor{comment}{\ \ \ \ \ *\ or\ 335,\ dependend\ on\ the\ CSEL\ bit.}}
\DoxyCodeLine{00321\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00322\ \ \ \ \ u16\ rightComparisonVal;}
\DoxyCodeLine{00323\ \ \ \ \ }
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{comment}{/*\ First\ coordinate\ where\ the\ vertical\ frame\ flipflop\ is\ checked.\ Either\ 51}}
\DoxyCodeLine{00325\ \textcolor{comment}{\ \ \ \ \ *\ or\ 55,\ dependend\ on\ the\ RSEL\ bit.}}
\DoxyCodeLine{00326\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00327\ \ \ \ \ u16\ upperComparisonVal;}
\DoxyCodeLine{00328\ \ \ \ \ }
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{comment}{/*\ Second\ coordinate\ where\ the\ vertical\ frame\ flipflop\ is\ checked.\ Either}}
\DoxyCodeLine{00330\ \textcolor{comment}{\ \ \ \ \ *\ 251\ or\ 247,\ dependend\ on\ the\ RSEL\ bit.}}
\DoxyCodeLine{00331\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00332\ \ \ \ \ u16\ lowerComparisonVal;}
\DoxyCodeLine{00333\ \ \ \ \ }
\DoxyCodeLine{00334\ \ \ \ \ }
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{comment}{//\ Raster\ interrupt\ logic}}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00338\ \ \ \ \ }
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{comment}{/*\ Indicates\ whether\ the\ current\ raster\ line\ matches\ the\ IRQ\ line.\ A}}
\DoxyCodeLine{00340\ \textcolor{comment}{\ \ \ \ \ *\ positive\ edge\ on\ this\ value\ triggers\ a\ raster\ interrupt.}}
\DoxyCodeLine{00341\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{keywordtype}{bool}\ lineMatchesIrqLine;}
\DoxyCodeLine{00343\ \ \ \ \ }
\DoxyCodeLine{00344\ \ \ \ \ }
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{comment}{//\ Housekeeping\ information}}
\DoxyCodeLine{00347\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00348\ \ \ \ \ }
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{comment}{/*\ Indicates\ wether\ we\ are\ in\ a\ visible\ display\ column\ or\ not.\ The\ visible}}
\DoxyCodeLine{00350\ \textcolor{comment}{\ \ \ \ \ *\ columns\ comprise\ canvas\ columns\ and\ border\ columns.\ The\ first\ visible}}
\DoxyCodeLine{00351\ \textcolor{comment}{\ \ \ \ \ *\ column\ is\ drawn\ in\ cycle\ 14\ (first\ left\ border\ column)\ and\ the\ last\ in}}
\DoxyCodeLine{00352\ \textcolor{comment}{\ \ \ \ \ *\ cycle\ 61\ (fourth\ right\ border\ column).}}
\DoxyCodeLine{00353\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{keywordtype}{bool}\ isVisibleColumn;}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{comment}{//\ True\ if\ the\ current\ scanline\ belongs\ to\ the\ VBLANK\ area}}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keywordtype}{bool}\ vblank;}
\DoxyCodeLine{00358\ \ \ \ \ }
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{comment}{//\ Indicates\ if\ the\ current\ scanline\ is\ a\ DMA\ line\ (bad\ line)}}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordtype}{bool}\ badLine;}
\DoxyCodeLine{00361\ \ \ \ \ }
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{comment}{/*\ True,\ if\ DMA\ lines\ can\ occurr\ within\ the\ current\ frame.\ Bad\ lines\ can}}
\DoxyCodeLine{00363\ \textcolor{comment}{\ \ \ \ \ *\ occur\ only\ if\ the\ DEN\ bit\ was\ set\ during\ an\ arbitary\ cycle\ in\ scanline}}
\DoxyCodeLine{00364\ \textcolor{comment}{\ \ \ \ \ *\ 30.\ The\ DEN\ bit\ is\ located\ in\ control\ register\ 1\ (0x11).}}
\DoxyCodeLine{00365\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordtype}{bool}\ DENwasSetInLine30;}
\DoxyCodeLine{00367\ \ \ \ \ }
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{comment}{/*\ Current\ display\ State}}
\DoxyCodeLine{00369\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00370\ \textcolor{comment}{\ \ \ \ \ *\ "{}The\ text/bitmap\ display\ logic\ in\ the\ VICII\ is\ in\ one\ of\ two\ states\ at}}
\DoxyCodeLine{00371\ \textcolor{comment}{\ \ \ \ \ *\ \ any\ time:\ The\ idle\ state\ and\ the\ display\ state.}}
\DoxyCodeLine{00372\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00373\ \textcolor{comment}{\ \ \ \ \ *\ \ -\/\ In\ display\ state,\ c-\/\ and\ g-\/accesses\ take\ place,\ the\ addresses\ and}}
\DoxyCodeLine{00374\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ interpretation\ of\ the\ data\ depend\ on\ the\ selected\ display\ mode.}}
\DoxyCodeLine{00375\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00376\ \textcolor{comment}{\ \ \ \ \ *\ \ -\/\ In\ idle\ state,\ only\ g-\/accesses\ occur.\ The\ VICII\ is\ either\ in\ idle\ or}}
\DoxyCodeLine{00377\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ display\ state"{}\ [C.B.]}}
\DoxyCodeLine{00378\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00379\ \ \ \ \ \textcolor{keywordtype}{bool}\ displayState;}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{comment}{//\ Sprites}}
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{comment}{//\ MOB\ data\ counter\ (16)}}
\DoxyCodeLine{00389\ \ \ \ \ u8\ mc[8];}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ \ \ \ \ \textcolor{comment}{//\ MCBASE\ register}}
\DoxyCodeLine{00392\ \ \ \ \ u8\ mcbase[8];}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{comment}{//\ Sprite\ pointer\ fetched\ during\ a\ pAccess}}
\DoxyCodeLine{00395\ \ \ \ \ u16\ spritePtr[8];}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \ \ \textcolor{comment}{//\ Flags\ the\ first\ DMA\ access\ for\ each\ sprite}}
\DoxyCodeLine{00398\ \ \ \ \ u8\ isFirstDMAcycle;}
\DoxyCodeLine{00399\ \ \ \ \ }
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{comment}{//\ Flags\ the\ second\ or\ third\ DMA\ access\ for\ each\ sprite}}
\DoxyCodeLine{00401\ \ \ \ \ u8\ isSecondDMAcycle;}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{comment}{//\ Determines\ if\ a\ sprite\ needs\ to\ be\ drawn\ in\ the\ current\ scanline}}
\DoxyCodeLine{00404\ \ \ \ \ u8\ spriteDisplay;}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{comment}{//\ Value\ of\ spriteDisplay,\ delayed\ by\ one\ cycle}}
\DoxyCodeLine{00407\ \ \ \ \ u8\ spriteDisplayDelayed;}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{comment}{//\ Sprite\ DMA\ on\ off\ register}}
\DoxyCodeLine{00410\ \ \ \ \ u8\ spriteDmaOnOff;}
\DoxyCodeLine{00411\ \ \ \ \ }
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{comment}{//\ Expansion\ flipflop\ (used\ to\ handle\ Y\ sprite\ stretching)}}
\DoxyCodeLine{00413\ \ \ \ \ u8\ expansionFF;}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{comment}{/*\ Remembers\ which\ bits\ the\ CPU\ has\ cleared\ in\ the\ expansion\ Y\ register}}
\DoxyCodeLine{00416\ \textcolor{comment}{\ \ \ \ \ *\ (D017).\ This\ value\ is\ set\ in\ pokeIO\ and\ cycle\ 15\ and\ read\ in\ cycle\ 16}}
\DoxyCodeLine{00417\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00418\ \ \ \ \ u8\ cleared\_bits\_in\_d017;}
\DoxyCodeLine{00419\ \ \ \ \ }
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{comment}{//\ Collision\ bits}}
\DoxyCodeLine{00421\ \ \ \ \ u8\ collision[8];}
\DoxyCodeLine{00422\ \ \ \ \ }
\DoxyCodeLine{00423\ \ \ \ \ }
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{comment}{//\ Lightpen}}
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ \ \ \textcolor{comment}{/*\ Current\ value\ of\ the\ LP\ pin.\ A\ negative\ transition\ on\ this\ pin\ triggers}}
\DoxyCodeLine{00429\ \textcolor{comment}{\ \ \ \ \ *\ a\ lightpen\ interrupt.}}
\DoxyCodeLine{00430\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordtype}{bool}\ lpLine;}
\DoxyCodeLine{00432\ \ \ \ \ }
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{comment}{/*\ Indicates\ whether\ the\ lightpen\ has\ triggered.\ This\ variable\ indicates}}
\DoxyCodeLine{00434\ \textcolor{comment}{\ \ \ \ \ *\ whether\ a\ lightpen\ interrupt\ has\ occurred\ within\ the\ current\ frame.\ The}}
\DoxyCodeLine{00435\ \textcolor{comment}{\ \ \ \ \ *\ variable\ is\ needed,\ because\ a\ lightpen\ interrupt\ can\ only\ occur\ once\ per}}
\DoxyCodeLine{00436\ \textcolor{comment}{\ \ \ \ \ *\ frame.}}
\DoxyCodeLine{00437\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00438\ \ \ \ \ \textcolor{keywordtype}{bool}\ lpIrqHasOccurred;}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \ \ }
\DoxyCodeLine{00441\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{comment}{//\ CPU\ control\ and\ memory\ access}}
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00444\ \ \ \ \ }
\DoxyCodeLine{00445\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00446\ \ \ \ \ }
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{comment}{/*\ Memory\ source\ lookup\ table.\ If\ VICII\ is\ not\ running\ in\ Ultimax\ mode,\ it}}
\DoxyCodeLine{00448\ \textcolor{comment}{\ \ \ \ \ *\ has\ access\ to\ RAM\ and\ the\ character\ Rom.\ In\ ultimax\ mode,\ VICII\ has}}
\DoxyCodeLine{00449\ \textcolor{comment}{\ \ \ \ \ *\ access\ to\ ROMH\ and\ some\ portions\ of\ RAM.}}
\DoxyCodeLine{00450\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00451\ \ \ \ \ MemoryType\ memSrc[16];}
\DoxyCodeLine{00452\ \ \ \ \ }
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{comment}{/*\ Indicates\ whether\ VICII\ is\ running\ in\ ultimax\ mode.\ Ultimax\ mode\ can\ be}}
\DoxyCodeLine{00454\ \textcolor{comment}{\ \ \ \ \ *\ enabled\ by\ external\ cartridges\ by\ pulling\ the\ game\ line\ low\ and\ keeping}}
\DoxyCodeLine{00455\ \textcolor{comment}{\ \ \ \ \ *\ the\ exrom\ line\ high.\ In\ ultimax\ mode,\ VICII\ has\ access\ to\ ROMH\ and\ some}}
\DoxyCodeLine{00456\ \textcolor{comment}{\ \ \ \ \ *\ portions\ of\ RAM.}}
\DoxyCodeLine{00457\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00458\ \ \ \ \ \textcolor{keywordtype}{bool}\ ultimax;}
\DoxyCodeLine{00459\ \ \ \ \ }
\DoxyCodeLine{00460\ \ \ \ \ \textcolor{comment}{/*\ Value\ on\ the\ data\ bus\ during\ the\ latest\ phi1\ access.\ Only\ VICII\ performs}}
\DoxyCodeLine{00461\ \textcolor{comment}{\ \ \ \ \ *\ a\ memory\ access\ during\ phi1.}}
\DoxyCodeLine{00462\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00463\ \ \ \ \ u8\ dataBusPhi1;}
\DoxyCodeLine{00464\ \ \ \ \ }
\DoxyCodeLine{00465\ \ \ \ \ \textcolor{comment}{/*\ Value\ on\ the\ data\ bus\ during\ the\ latest\ phi2\ access.\ VICII\ or\ the\ CPU}}
\DoxyCodeLine{00466\ \textcolor{comment}{\ \ \ \ \ *\ can\ perform\ a\ memory\ access\ during\ phi2.\ If\ none\ of\ them\ does,\ 0xFF\ will}}
\DoxyCodeLine{00467\ \textcolor{comment}{\ \ \ \ \ *\ be\ on\ the\ bus.}}
\DoxyCodeLine{00468\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00469\ \ \ \ \ u8\ dataBusPhi2;}
\DoxyCodeLine{00470\ \ \ \ \ }
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{comment}{/*\ Address\ bus.\ Whenever\ VICII\ performs\ a\ memory\ read,\ the\ generated\ memory}}
\DoxyCodeLine{00472\ \textcolor{comment}{\ \ \ \ \ *\ address\ is\ stored\ in\ this\ variable.}}
\DoxyCodeLine{00473\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00474\ \ \ \ \ u16\ addrBus;}
\DoxyCodeLine{00475\ \ \ \ \ }
\DoxyCodeLine{00476\ \ \ \ \ \textcolor{comment}{/*\ Current\ value\ of\ the\ BA\ line.\ Remember:\ Each\ CPU\ cycle\ is\ split\ into\ two}}
\DoxyCodeLine{00477\ \textcolor{comment}{\ \ \ \ \ *\ phases:}}
\DoxyCodeLine{00478\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00479\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ -\/\ phi1\ (First\ phase,\ LOW):\ VICII\ gets\ access\ to\ the\ bus}}
\DoxyCodeLine{00480\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ -\/\ phi2\ (Second\ phase,\ HIGH):\ CPU\ gets\ access\ to\ the\ bus}}
\DoxyCodeLine{00481\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00482\ \textcolor{comment}{\ \ \ \ \ *\ In\ rare\ cases,\ VICII\ needs\ access\ in\ the\ HIGH\ phase,\ too.\ To\ block\ the}}
\DoxyCodeLine{00483\ \textcolor{comment}{\ \ \ \ \ *\ CPU,\ the\ BA\ line\ is\ pulled\ down.\ Note\ that\ BA\ can\ be\ pulled\ down\ by}}
\DoxyCodeLine{00484\ \textcolor{comment}{\ \ \ \ \ *\ multiple\ sources\ (wired\ AND)\ and\ this\ variable\ indicates\ which\ sources}}
\DoxyCodeLine{00485\ \textcolor{comment}{\ \ \ \ \ *\ are\ holding\ the\ line\ low.}}
\DoxyCodeLine{00486\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00487\ \ \ \ \ TimeDelayed\ <u16,3>\ baLine\ =\ TimeDelayed\ <u16,3>\ ();}
\DoxyCodeLine{00488\ \ \ \ \ }
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{comment}{/*\ Start\ address\ of\ the\ currently\ selected\ memory\ bank.\ There\ are\ four}}
\DoxyCodeLine{00490\ \textcolor{comment}{\ \ \ \ \ *\ banks\ in\ total\ since\ the\ VICII\ chip\ can\ only\ 'see'\ 16\ KB\ of\ memory\ at}}
\DoxyCodeLine{00491\ \textcolor{comment}{\ \ \ \ \ *\ the\ same\ time.\ Two\ bank\ select\ bits\ in\ the\ CIA\ I/O\ space\ determine\ which}}
\DoxyCodeLine{00492\ \textcolor{comment}{\ \ \ \ \ *\ quarter\ of\ memory\ is\ currently\ seen.}}
\DoxyCodeLine{00493\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00494\ \textcolor{comment}{\ \ \ \ \ *\ +-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00495\ \textcolor{comment}{\ \ \ \ \ *\ |\ VALUE\ |\ BITS\ |\ \ BANK\ |\ STARTING\ |\ \ VIC-\/II\ CHIP\ RANGE\ \ \ \ \ \ |}}
\DoxyCodeLine{00496\ \textcolor{comment}{\ \ \ \ \ *\ |\ \ OF\ A\ |\ \ \ \ \ \ |\ \ \ \ \ \ \ |\ LOCATION\ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00497\ \textcolor{comment}{\ \ \ \ \ *\ +-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00498\ \textcolor{comment}{\ \ \ \ \ *\ |\ \ \ 0\ \ \ |\ \ 00\ \ |\ \ \ 3\ \ \ |\ \ \ 49152\ \ |\ (\$C000-\/\$FFFF)\ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00499\ \textcolor{comment}{\ \ \ \ \ *\ |\ \ \ 1\ \ \ |\ \ 01\ \ |\ \ \ 2\ \ \ |\ \ \ 32768\ \ |\ (\$8000-\/\$BFFF)\ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00500\ \textcolor{comment}{\ \ \ \ \ *\ |\ \ \ 2\ \ \ |\ \ 10\ \ |\ \ \ 1\ \ \ |\ \ \ 16384\ \ |\ (\$4000-\/\$7FFF)\ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00501\ \textcolor{comment}{\ \ \ \ \ *\ |\ \ \ 3\ \ \ |\ \ 11\ \ |\ \ \ 0\ \ \ |\ \ \ \ \ \ \ 0\ \ |\ (\$0000-\/\$3FFF)\ (DEFAULT)\ |}}
\DoxyCodeLine{00502\ \textcolor{comment}{\ \ \ \ \ *\ +-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00503\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00504\ \ \ \ \ u16\ bankAddr;}
\DoxyCodeLine{00505\ \ \ \ \ }
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{comment}{//\ Result\ of\ the\ lastest\ g-\/access}}
\DoxyCodeLine{00507\ \ \ \ \ TimeDelayed\ <u32,2>\ gAccessResult\ =\ TimeDelayed\ <u32,2>\ ();}
\DoxyCodeLine{00508\ \ \ \ \ }
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00511\ \ \ \ \ \textcolor{comment}{//\ Pipeline}}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00513\ \ \ \ \ }
\DoxyCodeLine{00514\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00515\ \ \ \ \ }
\DoxyCodeLine{00516\ \ \ \ \ \textcolor{comment}{/*\ Event\ pipeline.\ If\ a\ time\ delayed\ event\ needs\ to\ be\ performed,\ a\ flag\ is}}
\DoxyCodeLine{00517\ \textcolor{comment}{\ \ \ \ \ *\ set\ inside\ this\ variable\ and\ executed\ at\ the\ beginning\ of\ the\ next\ cycle.}}
\DoxyCodeLine{00518\ \textcolor{comment}{\ \ \ \ \ *\ See\ processDelayedActions()}}
\DoxyCodeLine{00519\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00520\ \ \ \ \ u64\ delay;}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00522\ \ \ \ \ }
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00524\ \ \ \ \ \textcolor{comment}{//\ Screen\ buffers\ and\ colors}}
\DoxyCodeLine{00525\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00526\ \ \ \ \ }
\DoxyCodeLine{00527\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00528\ \ \ \ \ }
\DoxyCodeLine{00529\ \ \ \ \ \textcolor{comment}{//\ C64\ colors\ in\ RGBA\ format\ (updated\ in\ updatePalette())}}
\DoxyCodeLine{00530\ \ \ \ \ u32\ rgbaTable[16];}
\DoxyCodeLine{00531\ \ \ \ \ }
\DoxyCodeLine{00532\ \ \ \ \ \textcolor{comment}{//\ Buffer\ storing\ background\ noise\ (random\ black\ and\ white\ pixels)}}
\DoxyCodeLine{00533\ \ \ \ \ u32\ *noise;}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{comment}{/*\ Texture\ buffers.\ VICII\ outputs\ the\ generated\ texture\ into\ these\ buffers.}}
\DoxyCodeLine{00536\ \textcolor{comment}{\ \ \ \ \ *\ At\ any\ time,\ one\ buffer\ is\ the\ working\ buffer\ and\ the\ other\ one\ is\ the}}
\DoxyCodeLine{00537\ \textcolor{comment}{\ \ \ \ \ *\ stable\ buffer.\ While\ VICII\ always\ writes\ into\ the\ working\ buffer,\ the}}
\DoxyCodeLine{00538\ \textcolor{comment}{\ \ \ \ \ *\ GUI\ accesses\ the\ stable\ buffer\ at\ a\ constant\ frame\ rate\ and\ copies\ it}}
\DoxyCodeLine{00539\ \textcolor{comment}{\ \ \ \ \ *\ into\ the\ texture\ RAM\ of\ the\ graphics\ card.}}
\DoxyCodeLine{00540\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00541\ \textcolor{comment}{\ \ \ \ \ *\ The\ emuTexture\ buffers\ contain\ the\ emulator\ texture.\ It\ is\ the\ texture}}
\DoxyCodeLine{00542\ \textcolor{comment}{\ \ \ \ \ *\ that\ is\ usually\ drawn\ by\ the\ GUI.\ The\ dmaTexture\ buffers\ contain\ the}}
\DoxyCodeLine{00543\ \textcolor{comment}{\ \ \ \ \ *\ texture\ generated\ by\ the\ DMA\ debugger.\ If\ DMA\ debugging\ is\ enabled,\ this}}
\DoxyCodeLine{00544\ \textcolor{comment}{\ \ \ \ \ *\ texture\ is\ superimposed\ on\ the\ emulator\ texture.}}
\DoxyCodeLine{00545\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00546\ \ \ \ \ u32\ *emuTexture1\ =\ \textcolor{keyword}{new}\ u32[TEX\_HEIGHT\ *\ TEX\_WIDTH];}
\DoxyCodeLine{00547\ \ \ \ \ u32\ *emuTexture2\ =\ \textcolor{keyword}{new}\ u32[TEX\_HEIGHT\ *\ TEX\_WIDTH];}
\DoxyCodeLine{00548\ \ \ \ \ u32\ *dmaTexture1\ =\ \textcolor{keyword}{new}\ u32[TEX\_HEIGHT\ *\ TEX\_WIDTH];}
\DoxyCodeLine{00549\ \ \ \ \ u32\ *dmaTexture2\ =\ \textcolor{keyword}{new}\ u32[TEX\_HEIGHT\ *\ TEX\_WIDTH];}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \ \ \ \ \textcolor{comment}{/*\ Pointer\ to\ the\ current\ working\ texture.\ This\ variable\ points\ either\ to}}
\DoxyCodeLine{00552\ \textcolor{comment}{\ \ \ \ \ *\ the\ first\ or\ the\ second\ texture\ buffer.\ After\ a\ frame\ has\ been\ finished,}}
\DoxyCodeLine{00553\ \textcolor{comment}{\ \ \ \ \ *\ the\ pointer\ is\ redirected\ to\ the\ other\ buffer.}}
\DoxyCodeLine{00554\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00555\ \ \ \ \ u32\ *emuTexture;}
\DoxyCodeLine{00556\ \ \ \ \ u32\ *dmaTexture;}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{comment}{/*\ Pointer\ to\ the\ beginning\ of\ the\ current\ scanline\ inside\ the\ current}}
\DoxyCodeLine{00559\ \textcolor{comment}{\ \ \ \ \ *\ working\ textures.\ These\ pointers\ are\ used\ by\ all\ rendering\ methods\ to}}
\DoxyCodeLine{00560\ \textcolor{comment}{\ \ \ \ \ *\ write\ pixels.\ It\ always\ points\ to\ the\ beginning\ of\ a\ scanline,\ either}}
\DoxyCodeLine{00561\ \textcolor{comment}{\ \ \ \ \ *\ the\ first\ or\ the\ second\ texture\ buffer.\ They\ are\ reset\ at\ the\ beginning}}
\DoxyCodeLine{00562\ \textcolor{comment}{\ \ \ \ \ *\ of\ each\ frame\ and\ incremented\ at\ the\ beginning\ of\ each\ scanline.}}
\DoxyCodeLine{00563\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00564\ \ \ \ \ u32\ *emuTexturePtr;}
\DoxyCodeLine{00565\ \ \ \ \ u32\ *dmaTexturePtr;}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00567\ \ \ \ \ \textcolor{comment}{/*\ VICII\ utilizes\ a\ depth\ buffer\ to\ determine\ pixel\ priority.\ The\ render}}
\DoxyCodeLine{00568\ \textcolor{comment}{\ \ \ \ \ *\ routines\ only\ write\ a\ color\ value,\ if\ it\ is\ closer\ to\ the\ view\ point.}}
\DoxyCodeLine{00569\ \textcolor{comment}{\ \ \ \ \ *\ The\ depth\ of\ the\ closest\ pixel\ is\ kept\ in\ this\ buffer.\ The\ lower\ the}}
\DoxyCodeLine{00570\ \textcolor{comment}{\ \ \ \ \ *\ value,\ the\ closer\ it\ is\ to\ the\ viewer.}}
\DoxyCodeLine{00571\ \textcolor{comment}{\ \ \ \ \ *\ The\ depth\ values\ have\ been\ chosen\ in\ a\ way\ that\ preserves\ the\ source}}
\DoxyCodeLine{00572\ \textcolor{comment}{\ \ \ \ \ *\ of\ the\ drawn\ pixel\ (border\ pixel,\ sprite\ pixel,\ etc.).}}
\DoxyCodeLine{00573\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00574\ \ \ \ \ u8\ zBuffer[TEX\_WIDTH];}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{comment}{/*\ Offset\ into\ to\ pixelBuffer.\ This\ variable\ points\ to\ the\ first\ pixel\ of}}
\DoxyCodeLine{00577\ \textcolor{comment}{\ \ \ \ \ *\ the\ currently\ drawn\ 8\ pixel\ chunk.}}
\DoxyCodeLine{00578\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00579\ \ \ \ \ \textcolor{keywordtype}{short}\ bufferoffset;}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ \ \ }
\DoxyCodeLine{00582\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00583\ \ \ \ \ \textcolor{comment}{//\ Debugging}}
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00585\ \ \ \ \ }
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{comment}{//\ Lookup\ table\ for\ DMA\ debugging\ colors}}
\DoxyCodeLine{00587\ \ \ \ \ u32\ debugColor[6][4];}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00590\ \ \ \ \ }
\DoxyCodeLine{00591\ \ \ \ \ \textcolor{comment}{//\ Filename\ used\ by\ dumpTexture()}}
\DoxyCodeLine{00592\ \ \ \ \ \textcolor{keywordtype}{string}\ dumpTexturePath\ =\ \textcolor{stringliteral}{"{}texture"{}};}
\DoxyCodeLine{00593\ \ \ \ \ }
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{comment}{//\ Pixel\ area\ used\ by\ dumpTexture()}}
\DoxyCodeLine{00595\ \ \ \ \ isize\ x1\ =\ 104;}
\DoxyCodeLine{00596\ \ \ \ \ isize\ y1\ =\ 16;}
\DoxyCodeLine{00597\ \ \ \ \ isize\ x2\ =\ 488;}
\DoxyCodeLine{00598\ \ \ \ \ isize\ y2\ =\ 290;}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ \ \ \ \ }
\DoxyCodeLine{00601\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{comment}{//\ Initializing}}
\DoxyCodeLine{00603\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00604\ \ \ \ \ }
\DoxyCodeLine{00605\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00606\ }
\DoxyCodeLine{00607\ \ \ \ \ VICII(C64\ \&ref);}
\DoxyCodeLine{00608\ }
\DoxyCodeLine{00609\ \ \ \ \ \textcolor{keywordtype}{void}\ \_initialize()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00611\ \ \ \ \ \textcolor{keywordtype}{void}\ initFuncTable(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ revision);}
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{keywordtype}{void}\ initFuncTable(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ revision,\ u16\ flags);}
\DoxyCodeLine{00613\ }
\DoxyCodeLine{00614\ \ \ \ \ \textcolor{keywordtype}{void}\ updateVicFunctionTable();}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00617\ \ \ \ \ }
\DoxyCodeLine{00618\ \ \ \ \ \textcolor{keywordtype}{void}\ resetEmuTexture(isize\ nr);}
\DoxyCodeLine{00619\ \ \ \ \ \textcolor{keywordtype}{void}\ resetEmuTextures()\ \{\ resetEmuTexture(1);\ resetEmuTexture(2);\ \}}
\DoxyCodeLine{00620\ \ \ \ \ \textcolor{keywordtype}{void}\ resetDmaTexture(isize\ nr);}
\DoxyCodeLine{00621\ \ \ \ \ \textcolor{keywordtype}{void}\ resetDmaTextures()\ \{\ resetDmaTexture(1);\ resetDmaTexture(2);\ \}}
\DoxyCodeLine{00622\ \ \ \ \ \textcolor{keywordtype}{void}\ resetTexture(u32\ *p);}
\DoxyCodeLine{00623\ }
\DoxyCodeLine{00624\ \ \ \ \ \textcolor{comment}{//\ ViciiFunc\ getViciiFunc(VICIIRevision\ revision,\ u16\ flags,\ isize\ cycle);}}
\DoxyCodeLine{00625\ \ \ \ \ ViciiFunc\ getViciiFunc(u16\ flags,\ isize\ cycle);}
\DoxyCodeLine{00626\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ ViciiFunc\ getViciiFunc(isize\ cycle);}
\DoxyCodeLine{00627\ }
\DoxyCodeLine{00628\ \ \ \ \ }
\DoxyCodeLine{00629\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00630\ \ \ \ \ \textcolor{comment}{//\ Methods\ from\ CoreObject}}
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00633\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00634\ \ \ \ \ }
\DoxyCodeLine{00635\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *getDescription()\textcolor{keyword}{\ const\ override\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}VICII"{}};\ \}}
\DoxyCodeLine{00636\ \ \ \ \ \textcolor{keywordtype}{void}\ \_dump(Category\ category,\ std::ostream\&\ os)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00637\ }
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00639\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00640\ \ \ \ \ \textcolor{comment}{//\ Methods\ from\ CoreComponent}}
\DoxyCodeLine{00641\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{keywordtype}{void}\ \_trackOn()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{keywordtype}{void}\ \_trackOff()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00647\ }
\DoxyCodeLine{00648\ \ \ \ \ VICII\&\ operator=\ (\textcolor{keyword}{const}\ VICII\&\ other)\ \{}
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ CLONE(dmaDebugger)}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ CLONE(reg)}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ CLONE(rasterIrqLine)}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ CLONE(latchedLPX)}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ CLONE(latchedLPY)}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ CLONE(memSelect)}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ CLONE(irr)}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ CLONE(imr)}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ CLONE(refreshCounter)}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ CLONE(xCounter)}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ CLONE(yCounter)}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ CLONE(vc)}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ CLONE(vcBase)}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ CLONE(rc)}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(videoMatrix)}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(colorLine)}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ CLONE(vmli)}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ CLONE(sr)}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(spriteSr)}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ CLONE(spriteSrActive)}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ CLONE(spriteSpriteCollision)}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ CLONE(spriteBackgroundColllision)}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ CLONE(flipflops)}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ CLONE(verticalFrameFFsetCond)}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ CLONE(leftComparisonVal)}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ CLONE(rightComparisonVal)}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ CLONE(upperComparisonVal)}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ CLONE(lowerComparisonVal)}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ CLONE(lineMatchesIrqLine)}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ CLONE(isVisibleColumn)}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ CLONE(vblank)}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ CLONE(badLine)}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ CLONE(DENwasSetInLine30)}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ CLONE(displayState)}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(mc)}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(mcbase)}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(spritePtr)}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ CLONE(isFirstDMAcycle)}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ CLONE(isSecondDMAcycle)}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ CLONE(spriteDisplay)}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ CLONE(spriteDisplayDelayed)}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ CLONE(spriteDmaOnOff)}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ CLONE(expansionFF)}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ CLONE(cleared\_bits\_in\_d017)}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(collision)}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ CLONE(lpLine)}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ CLONE(lpIrqHasOccurred)}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(memSrc)}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ CLONE(ultimax)}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ CLONE(dataBusPhi1)}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ CLONE(dataBusPhi2)}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ CLONE(addrBus)}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ CLONE(baLine)}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ CLONE(bankAddr)}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ CLONE(gAccessResult)}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ CLONE(delay)}
\DoxyCodeLine{00707\ }
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(rgbaTable)}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ CLONE(bufferoffset)}
\DoxyCodeLine{00711\ }
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ CLONE\_ARRAY(memSrc)}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ CLONE(isPAL)}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ CLONE(isNTSC)}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ CLONE(is856x)}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ CLONE(is656x)}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ CLONE(config)}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ updateVicFunctionTable();}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00722\ \ \ \ \ \}}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00725\ \ \ \ \ \textcolor{keywordtype}{void}\ serialize(T\&\ worker)}
\DoxyCodeLine{00726\ \ \ \ \ \{}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ worker}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ <<\ dmaDebugger}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ <<\ reg.current}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ <<\ reg.delayed}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ <<\ rasterIrqLine}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ <<\ latchedLPX}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ <<\ latchedLPY}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ <<\ memSelect}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ <<\ irr}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ <<\ imr}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ <<\ refreshCounter}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ <<\ xCounter}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ <<\ yCounter}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ <<\ vc}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ <<\ vcBase}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ <<\ rc}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ <<\ videoMatrix}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ <<\ colorLine}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ <<\ vmli}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ <<\ sr.data}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ <<\ sr.canLoad}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ <<\ sr.mcFlop}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ <<\ sr.latchedChr}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ <<\ sr.latchedCol}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ <<\ sr.colorbits}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ <<\ spriteSr}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ <<\ spriteSrActive}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ <<\ spriteSpriteCollision}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ <<\ spriteBackgroundColllision}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ <<\ flipflops.current.vertical}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ <<\ flipflops.current.main}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ <<\ flipflops.delayed.vertical}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ <<\ flipflops.delayed.main}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ <<\ verticalFrameFFsetCond}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ <<\ leftComparisonVal}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ <<\ rightComparisonVal}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ <<\ upperComparisonVal}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ <<\ lowerComparisonVal}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ <<\ lineMatchesIrqLine}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ <<\ isVisibleColumn}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ <<\ vblank}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ <<\ badLine}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ <<\ DENwasSetInLine30}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ <<\ displayState}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ <<\ mc}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ <<\ mcbase}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ <<\ spritePtr}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ <<\ isFirstDMAcycle}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ <<\ isSecondDMAcycle}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ <<\ spriteDisplay}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ <<\ spriteDisplayDelayed}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ <<\ spriteDmaOnOff}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ <<\ expansionFF}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ <<\ cleared\_bits\_in\_d017}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ <<\ collision}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ <<\ lpLine}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ <<\ lpIrqHasOccurred}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ <<\ memSrc}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ <<\ ultimax}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ <<\ dataBusPhi1}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ <<\ dataBusPhi2}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ <<\ addrBus}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \ \ <<\ baLine}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ <<\ bankAddr}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ <<\ gAccessResult}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ <<\ delay}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ <<\ bufferoffset;}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isResetter(worker))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00798\ }
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ worker}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ <<\ memSrc}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ <<\ isPAL}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ <<\ isNTSC}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ <<\ is856x}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ <<\ is656x}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ <<\ config.revision}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ <<\ config.awaiting}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ <<\ config.powerSave}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ <<\ config.grayDotBug}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ <<\ config.glueLogic;}
\DoxyCodeLine{00812\ }
\DoxyCodeLine{00813\ \ \ \ \ \}\ SERIALIZERS(serialize);}
\DoxyCodeLine{00814\ }
\DoxyCodeLine{00815\ \ \ \ \ \textcolor{keywordtype}{void}\ \_reset(\textcolor{keywordtype}{bool}\ hard)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00816\ }
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00818\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00819\ \ \ \ \ \textcolor{comment}{//\ Methods\ from\ Inspectable}}
\DoxyCodeLine{00820\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00821\ }
\DoxyCodeLine{00822\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00823\ }
\DoxyCodeLine{00824\ \ \ \ \ \textcolor{keywordtype}{bool}\ autoInspect()\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00825\ \ \ \ \ \textcolor{keywordtype}{void}\ recordState(VICIIInfo\ \&result)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00826\ \ \ \ \ \textcolor{keywordtype}{void}\ recordStats(VICIIStats\ \&result)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00827\ \ \ \ \ \textcolor{keywordtype}{void}\ clearStats();}
\DoxyCodeLine{00828\ }
\DoxyCodeLine{00829\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00830\ }
\DoxyCodeLine{00831\ \ \ \ \ SpriteInfo\ getSpriteInfo(isize\ nr);}
\DoxyCodeLine{00832\ }
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00835\ \ \ \ \ \textcolor{comment}{//\ Configuring}}
\DoxyCodeLine{00836\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00837\ }
\DoxyCodeLine{00838\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00839\ }
\DoxyCodeLine{00840\ \ \ \ \ \textcolor{keyword}{const}\ VICIIConfig\ \&getConfig()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ config;\ \}}
\DoxyCodeLine{00841\ \ \ \ \ \textcolor{keyword}{const}\ ConfigOptions\ \&getOptions()\textcolor{keyword}{\ const\ override\ }\{\ \textcolor{keywordflow}{return}\ options;\ \}}
\DoxyCodeLine{00842\ \ \ \ \ i64\ getOption(\mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8}{Option}}\ opt)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00843\ \ \ \ \ \textcolor{keywordtype}{void}\ setOption(\mbox{\hyperlink{_option_types_8h_a273e435dabd576e6dcff3f18024d1fa8}{Option}}\ opt,\ i64\ value)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00844\ }
\DoxyCodeLine{00845\ \ \ \ \ \textcolor{keywordtype}{bool}\ dmaDebug()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ dmaDebugger.config.dmaDebug;\ \}}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00848\ \ \ \ \ }
\DoxyCodeLine{00849\ \ \ \ \ \textcolor{keywordtype}{void}\ updateRevision();}
\DoxyCodeLine{00850\ \ \ \ \ \textcolor{keywordtype}{void}\ setRevision(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ revision);}
\DoxyCodeLine{00851\ }
\DoxyCodeLine{00852\ \ \ \ \ }
\DoxyCodeLine{00853\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00854\ \ \ \ \ \textcolor{comment}{//\ Deriving\ chip\ properties}}
\DoxyCodeLine{00855\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00856\ \ \ \ \ }
\DoxyCodeLine{00857\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00858\ \ \ \ \ }
\DoxyCodeLine{00859\ \ \ \ \ \textcolor{comment}{//\ Returns\ true\ if\ a\ PAL\ or\ an\ NTSC\ chip\ is\ plugged\ in}}
\DoxyCodeLine{00860\ \ \ \ \ \textcolor{keywordtype}{bool}\ pal()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ isPAL;\ \}}
\DoxyCodeLine{00861\ \ \ \ \ \textcolor{keywordtype}{bool}\ ntsc()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ isNTSC;\ \}}
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{comment}{//\ Returns\ true\ if\ light\ pen\ interrupts\ are\ triggered\ with\ a\ delay}}
\DoxyCodeLine{00864\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ delayedLightPenIrqs(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ rev);}
\DoxyCodeLine{00865\ \ \ \ \ \textcolor{keywordtype}{bool}\ delayedLightPenIrqs()\ \{\ \textcolor{keywordflow}{return}\ delayedLightPenIrqs(config.revision);\ \}}
\DoxyCodeLine{00866\ }
\DoxyCodeLine{00867\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ display\ refresh\ rate}}
\DoxyCodeLine{00868\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{double}\ getFps(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ rev);}
\DoxyCodeLine{00869\ \ \ \ \ \textcolor{keywordtype}{double}\ getFps()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getFps(config.revision);\ \}}
\DoxyCodeLine{00870\ }
\DoxyCodeLine{00871\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ clock\ frequency}}
\DoxyCodeLine{00872\ \ \ \ \ \textcolor{keyword}{static}\ isize\ getFrequency(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ rev);}
\DoxyCodeLine{00873\ \ \ \ \ isize\ getFrequency()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getFrequency(config.revision);\ \}}
\DoxyCodeLine{00874\ \ \ \ \ }
\DoxyCodeLine{00875\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ number\ of\ CPU\ cycles\ performed\ per\ scanline}}
\DoxyCodeLine{00876\ \ \ \ \ \textcolor{keyword}{static}\ isize\ getCyclesPerLine(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ rev);}
\DoxyCodeLine{00877\ \ \ \ \ isize\ getCyclesPerLine()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getCyclesPerLine(config.revision);\ \}}
\DoxyCodeLine{00878\ }
\DoxyCodeLine{00879\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ number\ of\ scanline\ drawn\ per\ frame}}
\DoxyCodeLine{00880\ \ \ \ \ \textcolor{keyword}{static}\ isize\ getLinesPerFrame(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ rev);}
\DoxyCodeLine{00881\ \ \ \ \ isize\ getLinesPerFrame()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getLinesPerFrame(config.revision);\ \}}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00883\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ number\ of\ CPU\ cycles\ executed\ in\ one\ frame}}
\DoxyCodeLine{00884\ \ \ \ \ \textcolor{keyword}{static}\ isize\ getCyclesPerFrame(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ rev);}
\DoxyCodeLine{00885\ \ \ \ \ isize\ getCyclesPerFrame()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getCyclesPerFrame(config.revision);\ \}}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ number\ of\ visible\ scanlines\ in\ a\ single\ frame}}
\DoxyCodeLine{00888\ \ \ \ \ \textcolor{keyword}{static}\ isize\ numVisibleLines(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ rev);}
\DoxyCodeLine{00889\ \ \ \ \ \textcolor{keywordtype}{long}\ numVisibleLines()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ numVisibleLines(config.revision);\ \}}
\DoxyCodeLine{00890\ \ \ \ \ }
\DoxyCodeLine{00891\ \ \ \ \ \textcolor{comment}{//\ Indicates\ if\ VICII\ is\ affected\ by\ the\ gray-\/dot\ bug}}
\DoxyCodeLine{00892\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ hasGrayCodeBug(\mbox{\hyperlink{_v_i_c_i_i_types_8h_aa6907eb49d9f65564eca99d8b6cd3c44}{VICIIRevision}}\ rev);}
\DoxyCodeLine{00893\ \ \ \ \ \textcolor{keywordtype}{bool}\ hasGrayCodeBug()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ hasGrayCodeBug(config.revision);\ \}}
\DoxyCodeLine{00894\ }
\DoxyCodeLine{00895\ \ \ \ \ \textcolor{comment}{//\ Returns\ true\ if\ the\ end\ of\ the\ scanline\ has\ been\ reached}}
\DoxyCodeLine{00896\ \ \ \ \ \textcolor{keywordtype}{bool}\ isLastCycleInLine(isize\ cycle)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00897\ }
\DoxyCodeLine{00898\ \ \ \ \ \textcolor{comment}{//\ Returns\ true\ if\ scanline\ belongs\ to\ the\ VBLANK\ area}}
\DoxyCodeLine{00899\ \ \ \ \ \textcolor{keywordtype}{bool}\ isVBlankLine(isize\ line)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00900\ }
\DoxyCodeLine{00901\ }
\DoxyCodeLine{00902\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00903\ \ \ \ \ \textcolor{comment}{//\ Accessing\ the\ screen\ buffer\ and\ display\ properties}}
\DoxyCodeLine{00904\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00905\ \ \ \ \ }
\DoxyCodeLine{00906\ \ \ \ \ \textcolor{comment}{//\ Returns\ pointers\ to\ the\ stable\ textures}}
\DoxyCodeLine{00907\ \ \ \ \ u32\ *getTexture()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00908\ \ \ \ \ u32\ *getDmaTexture()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00909\ \ \ \ \ }
\DoxyCodeLine{00910\ \ \ \ \ \textcolor{comment}{//\ Returns\ a\ pointer\ to\ randon\ noise}}
\DoxyCodeLine{00911\ \ \ \ \ u32\ *getNoise()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00912\ \ \ \ \ }
\DoxyCodeLine{00913\ \ \ \ \ \textcolor{comment}{//\ Returns\ a\ C64\ color\ in\ 32\ bit\ big\ endian\ RGBA\ format}}
\DoxyCodeLine{00914\ \ \ \ \ u32\ getColor(isize\ nr)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ rgbaTable[nr];\ \}}
\DoxyCodeLine{00915\ \ \ \ \ u32\ getColor(isize\ nr,\ \mbox{\hyperlink{_v_i_c_i_i_types_8h_af59eb4c57176022b657e35f92a7d01c9}{Palette}}\ palette);}
\DoxyCodeLine{00916\ }
\DoxyCodeLine{00917\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00918\ \ \ \ \ }
\DoxyCodeLine{00919\ \ \ \ \ \textcolor{comment}{/*\ Updates\ the\ RGBA\ values\ for\ all\ sixteen\ C64\ colors.\ The\ base\ palette\ is}}
\DoxyCodeLine{00920\ \textcolor{comment}{\ \ \ \ \ *\ determined\ by\ the\ selected\ VICII\ model.}}
\DoxyCodeLine{00921\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00922\ \ \ \ \ \textcolor{keywordtype}{void}\ updatePalette();}
\DoxyCodeLine{00923\ }
\DoxyCodeLine{00924\ \ \ \ \ }
\DoxyCodeLine{00925\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00926\ \ \ \ \ \textcolor{comment}{//\ Accessing\ memory\ (VIC\_memory.cpp)}}
\DoxyCodeLine{00927\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00928\ }
\DoxyCodeLine{00929\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00930\ \ \ \ \ }
\DoxyCodeLine{00931\ \ \ \ \ \textcolor{comment}{//\ Peeks\ a\ value\ from\ a\ VICII\ register\ without\ side\ effects}}
\DoxyCodeLine{00932\ \ \ \ \ u8\ spypeek(u16\ addr)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00933\ \ \ \ \ }
\DoxyCodeLine{00934\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ ultimax\ flag}}
\DoxyCodeLine{00935\ \ \ \ \ u8\ getUltimax()\ \{\ \textcolor{keywordflow}{return}\ ultimax;\ \}}
\DoxyCodeLine{00936\ }
\DoxyCodeLine{00937\ \ \ \ \ \textcolor{comment}{//\ Sets\ the\ ultimax\ flag}}
\DoxyCodeLine{00938\ \ \ \ \ \textcolor{keywordtype}{void}\ setUltimax(\textcolor{keywordtype}{bool}\ value);}
\DoxyCodeLine{00939\ \ \ \ \ }
\DoxyCodeLine{00940\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ latest\ value\ of\ the\ VICII's\ data\ bus\ during\ phi1}}
\DoxyCodeLine{00941\ \ \ \ \ u8\ getDataBusPhi1()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ dataBusPhi1;\ \}}
\DoxyCodeLine{00942\ }
\DoxyCodeLine{00943\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ latest\ value\ of\ the\ VICII's\ data\ bus\ during\ phi2}}
\DoxyCodeLine{00944\ \ \ \ \ u8\ getDataBusPhi2()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ dataBusPhi2;\ \}}
\DoxyCodeLine{00945\ }
\DoxyCodeLine{00946\ \ \ \ \ \textcolor{comment}{/*\ Schedules\ the\ VICII\ bank\ to\ to\ switched.\ This\ method\ is\ called\ if\ the}}
\DoxyCodeLine{00947\ \textcolor{comment}{\ \ \ \ \ *\ bank\ switch\ is\ triggered\ by\ a\ change\ of\ CIA2::PA\ or\ CIA2::DDRA.}}
\DoxyCodeLine{00948\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00949\ \ \ \ \ \textcolor{keywordtype}{void}\ switchBank(u16\ addr);}
\DoxyCodeLine{00950\ }
\DoxyCodeLine{00951\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00952\ }
\DoxyCodeLine{00953\ \ \ \ \ \textcolor{comment}{/*\ Updates\ the\ VICII\ bank\ address.\ The\ new\ address\ is\ computed\ from\ the}}
\DoxyCodeLine{00954\ \textcolor{comment}{\ \ \ \ \ *\ provided\ bank\ number.}}
\DoxyCodeLine{00955\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00956\ \ \ \ \ \textcolor{keywordtype}{void}\ updateBankAddr(u8\ bank)\ \{\ bankAddr\ =\ (u16)(bank\ <<\ 14);\ \}}
\DoxyCodeLine{00957\ }
\DoxyCodeLine{00958\ \ \ \ \ \textcolor{comment}{/*\ Updates\ the\ VICII\ bank\ address.\ The\ new\ address\ is\ computed\ from\ the}}
\DoxyCodeLine{00959\ \textcolor{comment}{\ \ \ \ \ *\ bits\ in\ CIA2::PA.}}
\DoxyCodeLine{00960\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00961\ \ \ \ \ \textcolor{keywordtype}{void}\ updateBankAddr();}
\DoxyCodeLine{00962\ \ \ \ \ }
\DoxyCodeLine{00963\ \ \ \ \ \textcolor{comment}{//\ Reads\ a\ value\ from\ a\ VICII\ register}}
\DoxyCodeLine{00964\ \ \ \ \ u8\ peek(u16\ addr);}
\DoxyCodeLine{00965\ \ \ \ \ }
\DoxyCodeLine{00966\ \ \ \ \ \textcolor{comment}{//\ Writes\ a\ value\ into\ a\ VICII\ register}}
\DoxyCodeLine{00967\ \ \ \ \ \textcolor{keywordtype}{void}\ poke(u16\ addr,\ u8\ value);}
\DoxyCodeLine{00968\ \ \ \ \ }
\DoxyCodeLine{00969\ \ \ \ \ \textcolor{comment}{//\ Simulates\ a\ memory\ access\ via\ the\ address\ and\ data\ bus}}
\DoxyCodeLine{00970\ \ \ \ \ u8\ memAccess(u16\ addr);}
\DoxyCodeLine{00971\ }
\DoxyCodeLine{00972\ \ \ \ \ \textcolor{comment}{//\ Same\ as\ memAccess\ without\ side\ effects}}
\DoxyCodeLine{00973\ \ \ \ \ u8\ memSpyAccess(u16\ addr);}
\DoxyCodeLine{00974\ }
\DoxyCodeLine{00975\ \ \ \ \ \textcolor{comment}{//\ Returns\ true\ if\ memAccess\ will\ read\ from\ Character\ ROM}}
\DoxyCodeLine{00976\ \ \ \ \ \textcolor{keywordtype}{bool}\ isCharRomAddr(u16\ addr)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00977\ }
\DoxyCodeLine{00978\ \ \ \ \ \textcolor{comment}{//\ Performs\ a\ DRAM\ refresh\ (r-\/access)}}
\DoxyCodeLine{00979\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ rAccess();}
\DoxyCodeLine{00980\ \ \ \ \ }
\DoxyCodeLine{00981\ \ \ \ \ \textcolor{comment}{//\ Performs\ an\ idle\ access\ (i-\/access)}}
\DoxyCodeLine{00982\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ iAccess();}
\DoxyCodeLine{00983\ \ \ \ \ }
\DoxyCodeLine{00984\ \ \ \ \ \textcolor{comment}{//\ Performs\ a\ character\ access\ (c-\/access)}}
\DoxyCodeLine{00985\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cAccess();}
\DoxyCodeLine{00986\ \ \ \ \ }
\DoxyCodeLine{00987\ \ \ \ \ \textcolor{comment}{//\ Performs\ a\ graphics\ access\ (g-\/access)}}
\DoxyCodeLine{00988\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ gAccess();}
\DoxyCodeLine{00989\ }
\DoxyCodeLine{00990\ \ \ \ \ \textcolor{comment}{//\ Computes\ the\ g-\/access\ fetch\ address\ for\ different\ VICII\ models}}
\DoxyCodeLine{00991\ \ \ \ \ u16\ gAccessAddr85x();}
\DoxyCodeLine{00992\ \ \ \ \ u16\ gAccessAddr65x();}
\DoxyCodeLine{00993\ }
\DoxyCodeLine{00994\ \ \ \ \ \textcolor{comment}{/*\ Computes\ the\ g-\/access\ fetch\ address.\ The\ fetch\ address\ is\ influences\ by}}
\DoxyCodeLine{00995\ \textcolor{comment}{\ \ \ \ \ *\ both\ the\ BMM\ and\ ECM\ bit.}}
\DoxyCodeLine{00996\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00997\ \ \ \ \ u16\ gAccessAddr(\textcolor{keywordtype}{bool}\ bmm,\ \textcolor{keywordtype}{bool}\ ecm);}
\DoxyCodeLine{00998\ \ \ \ \ }
\DoxyCodeLine{00999\ \ \ \ \ \textcolor{comment}{//\ Performs\ a\ sprite\ pointer\ access\ (p-\/access)}}
\DoxyCodeLine{01000\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ pAccess(isize\ sprite);}
\DoxyCodeLine{01001\ \ \ \ \ }
\DoxyCodeLine{01002\ \ \ \ \ \textcolor{comment}{//\ Performs\ one\ of\ the\ three\ sprite\ data\ accesses}}
\DoxyCodeLine{01003\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags,\ isize\ sprite>\ \textcolor{keywordtype}{void}\ sAccess1();}
\DoxyCodeLine{01004\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags,\ isize\ sprite>\ \textcolor{keywordtype}{void}\ sAccess2();}
\DoxyCodeLine{01005\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags,\ isize\ sprite>\ \textcolor{keywordtype}{void}\ sAccess3();}
\DoxyCodeLine{01006\ \ \ \ \ }
\DoxyCodeLine{01007\ \ \ \ \ \textcolor{comment}{/*\ Finalizes\ the\ sprite\ data\ access.\ This\ method\ is\ invoked\ one\ cycle\ after}}
\DoxyCodeLine{01008\ \textcolor{comment}{\ \ \ \ \ *\ the\ second\ and\ third\ sprite\ DMA\ has\ occurred.}}
\DoxyCodeLine{01009\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01010\ \ \ \ \ \textcolor{keywordtype}{void}\ sFinalize(isize\ sprite);}
\DoxyCodeLine{01011\ \ \ \ \ }
\DoxyCodeLine{01012\ }
\DoxyCodeLine{01013\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01014\ \ \ \ \ \textcolor{comment}{//\ Handling\ the\ x\ and\ y\ counters}}
\DoxyCodeLine{01015\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01016\ \ \ \ \ }
\DoxyCodeLine{01017\ \ \ \ \ \textcolor{comment}{/*\ Returns\ the\ current\ scanline.\ This\ value\ is\ not\ always\ identical\ to}}
\DoxyCodeLine{01018\ \textcolor{comment}{\ \ \ \ \ *\ the\ yCounter,\ because\ the\ yCounter\ is\ incremented\ with\ a\ little\ delay.}}
\DoxyCodeLine{01019\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01020\ \ \ \ \ u16\ scanline()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01021\ }
\DoxyCodeLine{01022\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ current\ scanline\ cycle}}
\DoxyCodeLine{01023\ \ \ \ \ u8\ rastercycle()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01024\ }
\DoxyCodeLine{01025\ \ \ \ \ \textcolor{comment}{/*\ Indicates\ if\ yCounter\ needs\ to\ be\ reset\ in\ this\ scanline.\ PAL\ models}}
\DoxyCodeLine{01026\ \textcolor{comment}{\ \ \ \ \ *\ reset\ the\ yCounter\ in\ cycle\ 2\ in\ the\ first\ scanline\ wheras\ NTSC\ models}}
\DoxyCodeLine{01027\ \textcolor{comment}{\ \ \ \ \ *\ reset\ the\ yCounter\ in\ cycle\ 2\ in\ the\ middle\ of\ the\ lower\ border\ area.}}
\DoxyCodeLine{01028\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01029\ \ \ \ \ \textcolor{keywordtype}{bool}\ yCounterOverflow()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ scanline()\ ==\ (isPAL\ ?\ 0\ :\ 238);\ \}}
\DoxyCodeLine{01030\ }
\DoxyCodeLine{01031\ \ \ \ \ \textcolor{comment}{/*\ Matches\ the\ yCounter\ with\ the\ raster\ interrupt\ line\ and\ stores\ the}}
\DoxyCodeLine{01032\ \textcolor{comment}{\ \ \ \ \ *\ result.\ If\ a\ positive\ edge\ is\ detected,\ a\ raster\ interrupt\ is\ triggered.}}
\DoxyCodeLine{01033\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01034\ \ \ \ \ \textcolor{keywordtype}{void}\ checkForRasterIrq();}
\DoxyCodeLine{01035\ }
\DoxyCodeLine{01036\ \ \ \ \ }
\DoxyCodeLine{01037\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01038\ \ \ \ \ \textcolor{comment}{//\ Handling\ the\ border\ flip\ flops}}
\DoxyCodeLine{01039\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01040\ \ \ \ \ }
\DoxyCodeLine{01041\ \ \ \ \ \textcolor{comment}{/*\ "{}Der\ VIC\ benutzt\ zwei\ Flipflops,\ um\ den\ Rahmen\ um\ das\ Anzeigefenster}}
\DoxyCodeLine{01042\ \textcolor{comment}{\ \ \ \ \ *\ \ herum\ zu\ erzeugen:\ Ein\ Haupt-\/Rahmenflipflop\ und\ ein\ vertikales}}
\DoxyCodeLine{01043\ \textcolor{comment}{\ \ \ \ \ *\ \ Rahmenflipflop.\ [...]}}
\DoxyCodeLine{01044\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01045\ \textcolor{comment}{\ \ \ \ \ *\ \ The\ flip\ flops\ are\ switched\ according\ to\ the\ following\ rules:}}
\DoxyCodeLine{01046\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01047\ \textcolor{comment}{\ \ \ \ \ *\ \ 1.\ If\ the\ X\ coordinate\ reaches\ the\ right\ comparison\ value,\ the\ main}}
\DoxyCodeLine{01048\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ border\ flip\ flop\ is\ set.}}
\DoxyCodeLine{01049\ \textcolor{comment}{\ \ \ \ \ *\ \ 2.\ If\ the\ Y\ coordinate\ reaches\ the\ bottom\ comparison\ value\ in\ cycle\ 63,}}
\DoxyCodeLine{01050\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ the\ vertical\ border\ flip\ flop\ is\ set.}}
\DoxyCodeLine{01051\ \textcolor{comment}{\ \ \ \ \ *\ \ 3.\ If\ the\ Y\ coordinate\ reaches\ the\ top\ comparison\ value\ in\ cycle\ 63\ and}}
\DoxyCodeLine{01052\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ the\ DEN\ bit\ in\ register\ \$d011\ is\ set,\ the\ vertical\ border\ flip\ flop}}
\DoxyCodeLine{01053\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ is\ reset.}}
\DoxyCodeLine{01054\ \textcolor{comment}{\ \ \ \ \ *\ \ 4.\ If\ the\ X\ coordinate\ reaches\ the\ left\ comparison\ value\ and\ the\ Y}}
\DoxyCodeLine{01055\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ coordinate\ reaches\ the\ bottom\ one,\ the\ vertical\ border\ flip\ flop\ is}}
\DoxyCodeLine{01056\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ set.}}
\DoxyCodeLine{01057\ \textcolor{comment}{\ \ \ \ \ *\ \ 5.\ If\ the\ X\ coordinate\ reaches\ the\ left\ comparison\ value\ and\ the\ Y}}
\DoxyCodeLine{01058\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ coordinate\ reaches\ the\ top\ one\ and\ the\ DEN\ bit\ in\ register\ \$d011\ is}}
\DoxyCodeLine{01059\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ set,\ the\ vertical\ border\ flip\ flop\ is\ reset.}}
\DoxyCodeLine{01060\ \textcolor{comment}{\ \ \ \ \ *\ \ 6.\ If\ the\ X\ coordinate\ reaches\ the\ left\ comparison\ value\ and\ the}}
\DoxyCodeLine{01061\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ vertical\ border\ flip\ flop\ is\ not\ set,\ the\ main\ flip\ flop\ is\ reset."{}}}
\DoxyCodeLine{01062\ \textcolor{comment}{\ \ \ \ \ *\ [C.B.]}}
\DoxyCodeLine{01063\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01064\ \ \ \ \ }
\DoxyCodeLine{01065\ \ \ \ \ \textcolor{comment}{//\ Takes\ care\ of\ the\ vertical\ frame\ flipflop\ value\ (invoked\ in\ each\ cycle)}}
\DoxyCodeLine{01066\ \ \ \ \ \textcolor{keywordtype}{void}\ checkVerticalFrameFF();}
\DoxyCodeLine{01067\ \ \ \ \ }
\DoxyCodeLine{01068\ \ \ \ \ \textcolor{comment}{//\ Checks\ the\ frame\ fliplops\ at\ left\ border}}
\DoxyCodeLine{01069\ \ \ \ \ \textcolor{keywordtype}{void}\ checkFrameFlipflopsLeft(u16\ comparisonValue);}
\DoxyCodeLine{01070\ \ \ \ \ }
\DoxyCodeLine{01071\ \ \ \ \ \textcolor{comment}{//\ Checks\ the\ frame\ fliplops\ at\ right\ border}}
\DoxyCodeLine{01072\ \ \ \ \ \textcolor{keywordtype}{void}\ checkFrameFlipflopsRight(u16\ comparisonValue);}
\DoxyCodeLine{01073\ \ \ \ \ }
\DoxyCodeLine{01074\ \ \ \ \ \textcolor{comment}{//\ Sets\ the\ vertical\ frame\ flipflop\ with\ a\ delay\ of\ one\ cycle}}
\DoxyCodeLine{01075\ \ \ \ \ \textcolor{keywordtype}{void}\ setVerticalFrameFF(\textcolor{keywordtype}{bool}\ value);}
\DoxyCodeLine{01076\ \ \ \ \ }
\DoxyCodeLine{01077\ \ \ \ \ \textcolor{comment}{//\ Sets\ the\ main\ frame\ flipflop\ with\ a\ delay\ of\ one\ cycle}}
\DoxyCodeLine{01078\ \ \ \ \ \textcolor{keywordtype}{void}\ setMainFrameFF(\textcolor{keywordtype}{bool}\ value);}
\DoxyCodeLine{01079\ \ \ \ \ }
\DoxyCodeLine{01080\ \ \ \ \ \textcolor{comment}{//\ Returns\ a\ comparison\ value\ for\ the\ border\ flipflops}}
\DoxyCodeLine{01081\ \ \ \ \ u16\ leftComparisonValue()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ isCSEL()\ ?\ 24\ :\ 31;\ \}}
\DoxyCodeLine{01082\ \ \ \ \ u16\ rightComparisonValue()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ isCSEL()\ ?\ 344\ :\ 335;\ \}}
\DoxyCodeLine{01083\ \ \ \ \ u16\ upperComparisonValue()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ isRSEL()\ ?\ 51\ :\ 55;\ \}}
\DoxyCodeLine{01084\ \ \ \ \ u16\ lowerComparisonValue()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ isRSEL()\ ?\ 251\ :\ 247;\ \}}
\DoxyCodeLine{01085\ \ \ \ \ }
\DoxyCodeLine{01086\ }
\DoxyCodeLine{01087\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01088\ \ \ \ \ \textcolor{comment}{//\ Accessing\ registers}}
\DoxyCodeLine{01089\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01090\ }
\DoxyCodeLine{01091\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01092\ }
\DoxyCodeLine{01093\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ current\ value\ of\ the\ DEN\ (Display\ ENabled)\ bit}}
\DoxyCodeLine{01094\ \ \ \ \ \textcolor{keywordtype}{bool}\ DENbit()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ GET\_BIT(reg.current.ctrl1,\ 4);\ \}}
\DoxyCodeLine{01095\ }
\DoxyCodeLine{01096\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ masked\ CB13\ bit}}
\DoxyCodeLine{01097\ \ \ \ \ u8\ CB13()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ memSelect\ \&\ 0x08;\ \}}
\DoxyCodeLine{01098\ }
\DoxyCodeLine{01099\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ masked\ CB13/CB12/CB11\ bits}}
\DoxyCodeLine{01100\ \ \ \ \ u8\ CB13CB12CB11()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ memSelect\ \&\ 0x0E;\ \}}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ masked\ VM13/VM12/VM11/VM10\ bits}}
\DoxyCodeLine{01103\ \ \ \ \ u8\ VM13VM12VM11VM10()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ memSelect\ \&\ 0xF0;\ \}}
\DoxyCodeLine{01104\ }
\DoxyCodeLine{01105\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ state\ of\ the\ CSEL\ bit}}
\DoxyCodeLine{01106\ \ \ \ \ \textcolor{keywordtype}{bool}\ isCSEL()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ GET\_BIT(reg.current.ctrl2,\ 3);\ \}}
\DoxyCodeLine{01107\ \ \ \ \ }
\DoxyCodeLine{01108\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ state\ of\ the\ RSEL\ bit}}
\DoxyCodeLine{01109\ \ \ \ \ \textcolor{keywordtype}{bool}\ isRSEL()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ GET\_BIT(reg.current.ctrl1,\ 3);\ \}}
\DoxyCodeLine{01110\ }
\DoxyCodeLine{01111\ }
\DoxyCodeLine{01112\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01113\ \ \ \ \ \textcolor{comment}{//\ Handling\ DMA\ lines\ and\ the\ display\ state}}
\DoxyCodeLine{01114\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01115\ }
\DoxyCodeLine{01116\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01117\ \ \ \ \ }
\DoxyCodeLine{01118\ \ \ \ \ \textcolor{comment}{//\ Returns\ true\ if\ the\ bad\ line\ condition\ holds}}
\DoxyCodeLine{01119\ \ \ \ \ \textcolor{keywordtype}{bool}\ badLineCondition()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01120\ \ \ \ \ }
\DoxyCodeLine{01121\ \ \ \ \ }
\DoxyCodeLine{01122\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01123\ \ \ \ \ \textcolor{comment}{//\ Interacting\ with\ the\ CPU}}
\DoxyCodeLine{01124\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01125\ \ \ \ \ }
\DoxyCodeLine{01126\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01127\ \ \ \ \ }
\DoxyCodeLine{01128\ \ \ \ \ \textcolor{comment}{//\ Sets\ the\ value\ of\ the\ BA\ line\ which\ is\ connected\ to\ the\ CPU's\ RDY\ pin.}}
\DoxyCodeLine{01129\ \ \ \ \ \textcolor{keywordtype}{void}\ updateBA(u8\ value);}
\DoxyCodeLine{01130\ \ \ \ \ }
\DoxyCodeLine{01131\ \ \ \ \ \textcolor{comment}{/*\ Indicates\ if\ a\ c-\/access\ can\ occur.\ A\ c-\/access\ can\ only\ be\ performed\ if}}
\DoxyCodeLine{01132\ \textcolor{comment}{\ \ \ \ \ *\ the\ BA\ line\ is\ down\ for\ more\ than\ 2\ cycles.}}
\DoxyCodeLine{01133\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01134\ \ \ \ \ \textcolor{keywordtype}{bool}\ BApulledDownForAtLeastThreeCycles()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ baLine.delayed();\ \}}
\DoxyCodeLine{01135\ \ \ \ \ }
\DoxyCodeLine{01136\ \ \ \ \ \textcolor{comment}{//\ Triggers\ a\ VICII\ interrupt}}
\DoxyCodeLine{01137\ \ \ \ \ \textcolor{keywordtype}{void}\ triggerIrq(u8\ source);}
\DoxyCodeLine{01138\ }
\DoxyCodeLine{01139\ \ \ \ \ }
\DoxyCodeLine{01140\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01141\ \ \ \ \ \textcolor{comment}{//\ Handling\ lightpen\ events}}
\DoxyCodeLine{01142\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01143\ \ \ \ \ }
\DoxyCodeLine{01144\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01145\ \ \ \ \ }
\DoxyCodeLine{01146\ \ \ \ \ \textcolor{comment}{//\ Sets\ the\ value\ of\ the\ LP\ pin}}
\DoxyCodeLine{01147\ \ \ \ \ \textcolor{keywordtype}{void}\ setLP(\textcolor{keywordtype}{bool}\ value);}
\DoxyCodeLine{01148\ \ \ \ \ }
\DoxyCodeLine{01149\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01150\ }
\DoxyCodeLine{01151\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ coordinate\ of\ a\ light\ pen\ event}}
\DoxyCodeLine{01152\ \ \ \ \ u16\ lightpenX()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01153\ \ \ \ \ u16\ lightpenY()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01154\ \ \ \ \ }
\DoxyCodeLine{01155\ \ \ \ \ \textcolor{comment}{/*\ Trigger\ a\ lightpen\ interrupt\ if\ conditions\ are\ met.\ This\ function\ is}}
\DoxyCodeLine{01156\ \textcolor{comment}{\ \ \ \ \ *\ called\ on\ each\ negative\ transition\ of\ the\ LP\ pin.\ It\ latches\ the\ x\ and}}
\DoxyCodeLine{01157\ \textcolor{comment}{\ \ \ \ \ *\ y\ coordinates\ and\ immediately\ triggers\ an\ interrupt\ if\ a\ newer\ VICII}}
\DoxyCodeLine{01158\ \textcolor{comment}{\ \ \ \ \ *\ model\ is\ emulated.\ Older\ models\ trigger\ the\ interrupt\ later,\ at\ the}}
\DoxyCodeLine{01159\ \textcolor{comment}{\ \ \ \ \ *\ beginning\ of\ a\ new\ frame.}}
\DoxyCodeLine{01160\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01161\ \ \ \ \ \textcolor{keywordtype}{void}\ checkForLightpenIrq();}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01163\ \ \ \ \ \textcolor{comment}{/*\ Retriggers\ a\ lightpen\ interrupt\ if\ conditions\ are\ met.\ This\ function\ is}}
\DoxyCodeLine{01164\ \textcolor{comment}{\ \ \ \ \ *\ called\ at\ the\ beginning\ of\ each\ frame.\ If\ the\ lp\ line\ is\ still\ low\ at}}
\DoxyCodeLine{01165\ \textcolor{comment}{\ \ \ \ \ *\ this\ point\ of\ time,\ a\ lightpen\ interrupt\ is\ retriggered.\ Note\ that\ older}}
\DoxyCodeLine{01166\ \textcolor{comment}{\ \ \ \ \ *\ VICII\ models\ trigger\ interrupts\ only\ at\ this\ point\ in\ time.}}
\DoxyCodeLine{01167\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01168\ \ \ \ \ \textcolor{keywordtype}{void}\ checkForLightpenIrqAtStartOfFrame();}
\DoxyCodeLine{01169\ \ \ \ \ }
\DoxyCodeLine{01170\ \ \ \ \ }
\DoxyCodeLine{01171\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01172\ \ \ \ \ \textcolor{comment}{//\ Sprites}}
\DoxyCodeLine{01173\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01174\ }
\DoxyCodeLine{01175\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01176\ }
\DoxyCodeLine{01177\ \ \ \ \ \textcolor{comment}{//\ Gets\ the\ depth\ of\ a\ sprite\ (will\ be\ written\ into\ the\ z\ buffer)}}
\DoxyCodeLine{01178\ \ \ \ \ u8\ spriteDepth(isize\ nr)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01179\ \ \ \ \ }
\DoxyCodeLine{01180\ \ \ \ \ \textcolor{comment}{//\ Compares\ the\ Y\ coordinates\ of\ all\ sprites\ with\ the\ yCounter}}
\DoxyCodeLine{01181\ \ \ \ \ u8\ compareSpriteY()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01182\ \ \ \ \ }
\DoxyCodeLine{01183\ \ \ \ \ \textcolor{comment}{/*\ Turns\ off\ sprite\ dma\ if\ conditions\ are\ met.\ In\ cycle\ 16,\ the\ mcbase}}
\DoxyCodeLine{01184\ \textcolor{comment}{\ \ \ \ \ *\ pointer\ is\ advanced\ three\ bytes\ for\ all\ dma\ enabled\ sprites.\ Advancing}}
\DoxyCodeLine{01185\ \textcolor{comment}{\ \ \ \ \ *\ three\ bytes\ means\ that\ mcbase\ will\ then\ point\ to\ the\ next\ sprite\ line.}}
\DoxyCodeLine{01186\ \textcolor{comment}{\ \ \ \ \ *\ When\ mcbase\ reached\ 63,\ all\ 21\ sprite\ lines\ have\ been\ drawn\ and\ sprite}}
\DoxyCodeLine{01187\ \textcolor{comment}{\ \ \ \ \ *\ dma\ is\ switched\ off.\ The\ whole\ operation\ is\ skipped\ when\ the\ y\ expansion}}
\DoxyCodeLine{01188\ \textcolor{comment}{\ \ \ \ \ *\ flipflop\ is\ 0.\ This\ never\ happens\ for\ normal\ sprites\ (there\ is\ no}}
\DoxyCodeLine{01189\ \textcolor{comment}{\ \ \ \ \ *\ skipping\ then),\ but\ happens\ every\ other\ cycle\ for\ vertically\ expanded}}
\DoxyCodeLine{01190\ \textcolor{comment}{\ \ \ \ \ *\ sprites.\ Thus,\ mcbase\ advances\ for\ those\ sprites\ at\ half\ speed\ which}}
\DoxyCodeLine{01191\ \textcolor{comment}{\ \ \ \ \ *\ actually\ causes\ the\ expansion.}}
\DoxyCodeLine{01192\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01193\ \ \ \ \ \textcolor{keywordtype}{void}\ turnSpriteDmaOff();}
\DoxyCodeLine{01194\ }
\DoxyCodeLine{01195\ \ \ \ \ \textcolor{comment}{/*\ Turns\ on\ sprite\ dma\ accesses\ if\ conditions\ are\ met.\ This\ function\ is}}
\DoxyCodeLine{01196\ \textcolor{comment}{\ \ \ \ \ *\ called\ in\ cycle\ 55\ and\ cycle\ 56.}}
\DoxyCodeLine{01197\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01198\ \ \ \ \ \textcolor{keywordtype}{void}\ turnSpriteDmaOn();}
\DoxyCodeLine{01199\ }
\DoxyCodeLine{01200\ \ \ \ \ \textcolor{comment}{/*\ Turns\ sprite\ display\ on\ or\ off.\ This\ function\ is\ called\ in\ cycle\ 58.}}
\DoxyCodeLine{01201\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01202\ \ \ \ \ \textcolor{keywordtype}{void}\ turnSpritesOnOrOff();}
\DoxyCodeLine{01203\ \ \ \ \ }
\DoxyCodeLine{01204\ \ \ \ \ \textcolor{comment}{/*\ Loads\ a\ sprite\ shift\ register.\ The\ shift\ register\ is\ loaded\ with\ the}}
\DoxyCodeLine{01205\ \textcolor{comment}{\ \ \ \ \ *\ three\ data\ bytes\ fetched\ in\ the\ previous\ sAccesses.}}
\DoxyCodeLine{01206\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01207\ \ \ \ \ \textcolor{keywordtype}{void}\ loadSpriteShiftRegister(isize\ nr);}
\DoxyCodeLine{01208\ \ \ \ \ }
\DoxyCodeLine{01209\ \ \ \ \ \textcolor{comment}{/*\ Updates\ the\ sprite\ shift\ registers.\ Checks\ if\ a\ sprite\ has\ completed}}
\DoxyCodeLine{01210\ \textcolor{comment}{\ \ \ \ \ *\ it's\ last\ DMA\ fetch\ and\ calls\ loadSpriteShiftRegister()\ accordingly.}}
\DoxyCodeLine{01211\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01212\ \ \ \ \ \textcolor{keywordtype}{void}\ updateSpriteShiftRegisters();}
\DoxyCodeLine{01213\ \ \ \ \ }
\DoxyCodeLine{01214\ \ \ \ \ \textcolor{comment}{/*\ Toggles\ expansion\ flipflop\ for\ vertically\ stretched\ sprites.\ In\ cycle\ 56,}}
\DoxyCodeLine{01215\ \textcolor{comment}{\ \ \ \ \ *\ register\ D017\ is\ read\ and\ the\ flipflop\ gets\ inverted\ for\ all\ sprites\ with}}
\DoxyCodeLine{01216\ \textcolor{comment}{\ \ \ \ \ *\ vertical\ stretching\ enabled.\ When\ the\ flipflop\ goes\ down,\ advanceMCBase()}}
\DoxyCodeLine{01217\ \textcolor{comment}{\ \ \ \ \ *\ will\ have\ no\ effect\ in\ the\ next\ scanline.\ This\ causes\ each\ sprite\ line}}
\DoxyCodeLine{01218\ \textcolor{comment}{\ \ \ \ \ *\ to\ be\ drawn\ twice.}}
\DoxyCodeLine{01219\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01220\ \ \ \ \ \textcolor{keywordtype}{void}\ toggleExpansionFlipflop()\ \{\ expansionFF\ \string^=\ reg.current.sprExpandY;\ \}}
\DoxyCodeLine{01221\ \ \ \ \ }
\DoxyCodeLine{01222\ \ \ \ \ }
\DoxyCodeLine{01223\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01224\ \ \ \ \ \textcolor{comment}{//\ Running\ the\ device\ (VICII.cpp\ and\ VIC\_cycles\_xxx.cpp)}}
\DoxyCodeLine{01225\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01226\ }
\DoxyCodeLine{01227\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01228\ }
\DoxyCodeLine{01229\ \ \ \ \ \textcolor{comment}{/*\ Prepares\ VICII\ for\ drawing\ a\ new\ frame.\ This\ function\ is\ called\ prior\ to}}
\DoxyCodeLine{01230\ \textcolor{comment}{\ \ \ \ \ *\ the\ first\ cycle\ of\ each\ frame.}}
\DoxyCodeLine{01231\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01232\ \ \ \ \ \textcolor{keywordtype}{void}\ beginFrame();}
\DoxyCodeLine{01233\ }
\DoxyCodeLine{01234\ \ \ \ \ \textcolor{comment}{/*\ Prepares\ VICII\ for\ drawing\ a\ new\ scanline.\ This\ function\ is\ called}}
\DoxyCodeLine{01235\ \textcolor{comment}{\ \ \ \ \ *\ prior\ to\ the\ first\ cycle\ of\ each\ scanline.}}
\DoxyCodeLine{01236\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01237\ \ \ \ \ \textcolor{keywordtype}{void}\ beginScanline();}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \ \ \ \ \textcolor{comment}{/*\ Finishes\ up\ a\ scanline.\ This\ function\ is\ called\ after\ the\ last\ cycle}}
\DoxyCodeLine{01240\ \textcolor{comment}{\ \ \ \ \ *\ of\ each\ scanline.}}
\DoxyCodeLine{01241\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01242\ \ \ \ \ \textcolor{keywordtype}{void}\ endScanline();}
\DoxyCodeLine{01243\ }
\DoxyCodeLine{01244\ \ \ \ \ \textcolor{comment}{/*\ Finishes\ up\ a\ frame.\ This\ function\ is\ called\ after\ the\ last\ cycle\ of}}
\DoxyCodeLine{01245\ \textcolor{comment}{\ \ \ \ \ *\ each\ frame.}}
\DoxyCodeLine{01246\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01247\ \ \ \ \ \textcolor{keywordtype}{void}\ endFrame();}
\DoxyCodeLine{01248\ \ \ \ \ }
\DoxyCodeLine{01249\ \ \ \ \ \textcolor{comment}{/*\ Processes\ all\ time\ delayed\ actions.\ This\ function\ is\ called\ at\ the}}
\DoxyCodeLine{01250\ \textcolor{comment}{\ \ \ \ \ *\ beginning\ of\ each\ VICII\ cycle.}}
\DoxyCodeLine{01251\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01252\ \ \ \ \ \textcolor{keywordtype}{void}\ processDelayedActions();}
\DoxyCodeLine{01253\ \ \ \ \ }
\DoxyCodeLine{01254\ \ \ \ \ \textcolor{comment}{//\ Emulates\ a\ specific\ scanline\ cycle}}
\DoxyCodeLine{01255\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle1();}
\DoxyCodeLine{01256\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle2();}
\DoxyCodeLine{01257\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle3();}
\DoxyCodeLine{01258\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle4();}
\DoxyCodeLine{01259\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle5();}
\DoxyCodeLine{01260\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle6();}
\DoxyCodeLine{01261\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle7();}
\DoxyCodeLine{01262\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle8();}
\DoxyCodeLine{01263\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle9();}
\DoxyCodeLine{01264\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle10();}
\DoxyCodeLine{01265\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle11();}
\DoxyCodeLine{01266\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle12();}
\DoxyCodeLine{01267\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle13();}
\DoxyCodeLine{01268\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle14();}
\DoxyCodeLine{01269\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle15();}
\DoxyCodeLine{01270\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle16();}
\DoxyCodeLine{01271\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle17();}
\DoxyCodeLine{01272\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle18();}
\DoxyCodeLine{01273\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle19to54();}
\DoxyCodeLine{01274\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle55();}
\DoxyCodeLine{01275\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle56();}
\DoxyCodeLine{01276\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle57();}
\DoxyCodeLine{01277\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle58();}
\DoxyCodeLine{01278\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle59();}
\DoxyCodeLine{01279\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle60();}
\DoxyCodeLine{01280\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle61();}
\DoxyCodeLine{01281\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle62();}
\DoxyCodeLine{01282\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle63();}
\DoxyCodeLine{01283\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle64();}
\DoxyCodeLine{01284\ \ \ \ \ \textcolor{keyword}{template}\ <u16\ flags>\ \textcolor{keywordtype}{void}\ cycle65();}
\DoxyCodeLine{01285\ }
\DoxyCodeLine{01286\ \textcolor{preprocessor}{\#define\ DRAW\_SPRITES\_DMA1\ \(\backslash\)}}
\DoxyCodeLine{01287\ \textcolor{preprocessor}{assert(isFirstDMAcycle);\ assert(!isSecondDMAcycle);\ \(\backslash\)}}
\DoxyCodeLine{01288\ \textcolor{preprocessor}{if\ (!(flags\ \&\ HEADLESS\_CYCLE))\ \{\ drawSpritesSlowPath();\ \}}}
\DoxyCodeLine{01289\ }
\DoxyCodeLine{01290\ \textcolor{preprocessor}{\#define\ DRAW\_SPRITES\_DMA2\ \(\backslash\)}}
\DoxyCodeLine{01291\ \textcolor{preprocessor}{assert(!isFirstDMAcycle);\ assert(isSecondDMAcycle);\ \(\backslash\)}}
\DoxyCodeLine{01292\ \textcolor{preprocessor}{if\ (!(flags\ \&\ HEADLESS\_CYCLE))\ \{\ drawSpritesSlowPath();\ \}}}
\DoxyCodeLine{01293\ }
\DoxyCodeLine{01294\ \textcolor{preprocessor}{\#define\ DRAW\_SPRITES\ \(\backslash\)}}
\DoxyCodeLine{01295\ \textcolor{preprocessor}{assert(!isFirstDMAcycle\ \&\&\ !isSecondDMAcycle);\ \(\backslash\)}}
\DoxyCodeLine{01296\ \textcolor{preprocessor}{if\ (spriteDisplay\ \&\&\ !(flags\ \&\ HEADLESS\_CYCLE))\ \{\ drawSprites();\ \}}}
\DoxyCodeLine{01297\ }
\DoxyCodeLine{01298\ \textcolor{preprocessor}{\#define\ DRAW\_SPRITES59\ \(\backslash\)}}
\DoxyCodeLine{01299\ \textcolor{preprocessor}{if\ ((spriteDisplayDelayed\ ||\ spriteDisplay\ ||\ isSecondDMAcycle)\ \&\&\ !(flags\ \&\ HEADLESS\_CYCLE))\ \(\backslash\)}}
\DoxyCodeLine{01300\ \textcolor{preprocessor}{\{\ drawSpritesSlowPath();\ \}}}
\DoxyCodeLine{01301\ \ \ \ \ }
\DoxyCodeLine{01302\ \textcolor{preprocessor}{\#define\ DRAW\ \ \ if\ (!vblank\ \&\&\ !(flags\ \&\ HEADLESS\_CYCLE))\ \{\ drawCanvas();\ drawBorder();\ \};}}
\DoxyCodeLine{01303\ \textcolor{preprocessor}{\#define\ DRAW17\ if\ (!vblank\ \&\&\ !(flags\ \&\ HEADLESS\_CYCLE))\ \{\ drawCanvas();\ drawBorder17();\ \};}}
\DoxyCodeLine{01304\ \textcolor{preprocessor}{\#define\ DRAW55\ if\ (!vblank\ \&\&\ !(flags\ \&\ HEADLESS\_CYCLE))\ \{\ drawCanvas();\ drawBorder55();\ \};}}
\DoxyCodeLine{01305\ \textcolor{preprocessor}{\#define\ DRAW59\ if\ (!vblank\ \&\&\ !(flags\ \&\ HEADLESS\_CYCLE))\ \{\ drawCanvas();\ drawBorder();\ \};}}
\DoxyCodeLine{01306\ }
\DoxyCodeLine{01307\ \textcolor{preprocessor}{\#define\ END\_CYCLE\ \(\backslash\)}}
\DoxyCodeLine{01308\ \textcolor{preprocessor}{dataBusPhi2\ =\ 0xFF;\ \(\backslash\)}}
\DoxyCodeLine{01309\ \textcolor{preprocessor}{xCounter\ +=\ 8;\ \(\backslash\)}}
\DoxyCodeLine{01310\ \textcolor{preprocessor}{bufferoffset\ +=\ 8;\ \(\backslash\)}}
\DoxyCodeLine{01311\ \textcolor{preprocessor}{if\ (unlikely(delay))\ \{\ processDelayedActions();\ \}}}
\DoxyCodeLine{01312\ }
\DoxyCodeLine{01313\ \textcolor{preprocessor}{\#define\ END\_VISIBLE\_CYCLE\ \(\backslash\)}}
\DoxyCodeLine{01314\ \textcolor{preprocessor}{END\_CYCLE}}
\DoxyCodeLine{01315\ \ \ \ \ }
\DoxyCodeLine{01316\ \textcolor{preprocessor}{\#define\ BA\_LINE(x)\ updateBA(x);}}
\DoxyCodeLine{01317\ \ \ \ \ }
\DoxyCodeLine{01318\ \ \ \ \ }
\DoxyCodeLine{01319\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01320\ \ \ \ \ \textcolor{comment}{//\ Drawing\ routines\ (VIC\_draw.cpp)}}
\DoxyCodeLine{01321\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01322\ \ \ \ \ }
\DoxyCodeLine{01323\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01324\ }
\DoxyCodeLine{01325\ \ \ \ \ \textcolor{comment}{//\ Draws\ 8\ border\ pixels.\ Invoked\ inside\ draw().}}
\DoxyCodeLine{01326\ \ \ \ \ \textcolor{keywordtype}{void}\ drawBorder();}
\DoxyCodeLine{01327\ \ \ \ \ }
\DoxyCodeLine{01328\ \ \ \ \ \textcolor{comment}{//\ Draws\ the\ border\ pixels\ in\ cycle\ 17}}
\DoxyCodeLine{01329\ \ \ \ \ \textcolor{keywordtype}{void}\ drawBorder17();}
\DoxyCodeLine{01330\ \ \ \ \ }
\DoxyCodeLine{01331\ \ \ \ \ \textcolor{comment}{//\ Draws\ the\ border\ pixels\ in\ cycle\ 55}}
\DoxyCodeLine{01332\ \ \ \ \ \textcolor{keywordtype}{void}\ drawBorder55();}
\DoxyCodeLine{01333\ \ \ \ \ }
\DoxyCodeLine{01334\ \ \ \ \ \textcolor{comment}{//\ Draws\ 8\ canvas\ pixels}}
\DoxyCodeLine{01335\ \ \ \ \ \textcolor{keywordtype}{void}\ drawCanvas();}
\DoxyCodeLine{01336\ \ \ \ \ \textcolor{keywordtype}{void}\ drawCanvasFastPath();}
\DoxyCodeLine{01337\ \ \ \ \ \textcolor{keywordtype}{void}\ drawCanvasSlowPath();}
\DoxyCodeLine{01338\ }
\DoxyCodeLine{01339\ \ \ \ \ \textcolor{comment}{//\ Draws\ a\ single\ canvas\ pixel}}
\DoxyCodeLine{01340\ \ \ \ \ \textcolor{keywordtype}{void}\ drawCanvasPixel(u8\ pixel,\ u8\ mode,\ u8\ d016);}
\DoxyCodeLine{01341\ \ \ \ \ }
\DoxyCodeLine{01342\ \ \ \ \ \textcolor{comment}{//\ Reloads\ the\ sequencer\ shift\ register\ with\ the\ gAccess\ result}}
\DoxyCodeLine{01343\ \ \ \ \ \textcolor{keywordtype}{void}\ loadShiftRegister();}
\DoxyCodeLine{01344\ \ \ \ \ }
\DoxyCodeLine{01345\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01346\ \ \ \ \ \textcolor{comment}{//\ Drawing\ routines\ (VIC\_sprites.cpp)}}
\DoxyCodeLine{01347\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01348\ \ \ \ \ }
\DoxyCodeLine{01349\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01350\ \ \ \ \ }
\DoxyCodeLine{01351\ \ \ \ \ \textcolor{comment}{//\ Draws\ 8\ sprite\ pixels\ (see\ draw())}}
\DoxyCodeLine{01352\ \ \ \ \ \textcolor{keywordtype}{void}\ drawSprites();}
\DoxyCodeLine{01353\ \ \ \ \ \textcolor{keywordtype}{void}\ drawSpritesFastPath();}
\DoxyCodeLine{01354\ \ \ \ \ \textcolor{keywordtype}{void}\ drawSpritesSlowPath();}
\DoxyCodeLine{01355\ \ \ \ \ }
\DoxyCodeLine{01356\ \ \ \ \ \textcolor{comment}{/*\ Draws\ all\ sprite\ pixels\ for\ a\ single\ sprite.\ This\ function\ is\ used\ when}}
\DoxyCodeLine{01357\ \textcolor{comment}{\ \ \ \ \ *\ the\ fast\ path\ is\ taken.}}
\DoxyCodeLine{01358\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01359\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ multicolor>\ \textcolor{keywordtype}{void}\ drawSpriteNr(isize\ nr,\ \textcolor{keywordtype}{bool}\ enable,\ \textcolor{keywordtype}{bool}\ active);}
\DoxyCodeLine{01360\ }
\DoxyCodeLine{01361\ \ \ \ \ \textcolor{comment}{/*\ Draws\ a\ single\ sprite\ pixel\ for\ all\ sprites.\ This\ function\ is\ used\ when}}
\DoxyCodeLine{01362\ \textcolor{comment}{\ \ \ \ \ *\ the\ slow\ path\ is\ taken.}}
\DoxyCodeLine{01363\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01364\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ \ \ \ \ pixel\ :\ pixel\ number\ (0\ ...\ 7)}}
\DoxyCodeLine{01365\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ enableBits\ :\ the\ spriteDisplay\ bits}}
\DoxyCodeLine{01366\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ freezeBits\ :\ forces\ the\ sprites\ shift\ register\ to\ freeze\ temporarily}}
\DoxyCodeLine{01367\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01368\ \ \ \ \ \textcolor{keywordtype}{void}\ drawSpritePixel(isize\ pixel,\ u8\ enableBits,\ u8\ freezeBits);}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01370\ \ \ \ \ \textcolor{comment}{//\ Performs\ collision\ detection}}
\DoxyCodeLine{01371\ \ \ \ \ \textcolor{keywordtype}{void}\ checkCollisions();}
\DoxyCodeLine{01372\ \ \ \ \ }
\DoxyCodeLine{01373\ \ \ \ \ }
\DoxyCodeLine{01374\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01375\ \ \ \ \ \textcolor{comment}{//\ Low\ level\ drawing\ (pixel\ buffer\ access)}}
\DoxyCodeLine{01376\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01377\ \ \ \ \ }
\DoxyCodeLine{01378\ \ \ \ \ \textcolor{comment}{//\ Writes\ a\ single\ color\ value\ into\ the\ screenbuffer}}
\DoxyCodeLine{01379\ \textcolor{preprocessor}{\#define\ COLORIZE(index,color)\ \(\backslash\)}}
\DoxyCodeLine{01380\ \textcolor{preprocessor}{emuTexturePtr[index]\ =\ rgbaTable[color];}}
\DoxyCodeLine{01381\ \ \ \ \ }
\DoxyCodeLine{01382\ \ \ \ \ \textcolor{comment}{//\ Sets\ a\ single\ frame\ pixel}}
\DoxyCodeLine{01383\ \textcolor{preprocessor}{\#define\ SET\_FRAME\_PIXEL(pixel,color)\ \{\ \(\backslash\)}}
\DoxyCodeLine{01384\ \textcolor{preprocessor}{isize\ index\ =\ bufferoffset\ +\ pixel;\ \(\backslash\)}}
\DoxyCodeLine{01385\ \textcolor{preprocessor}{COLORIZE(index,\ color);\ \(\backslash\)}}
\DoxyCodeLine{01386\ \textcolor{preprocessor}{zBuffer[index]\ =\ DEPTH\_BORDER;\ \}}}
\DoxyCodeLine{01387\ \ \ \ \ }
\DoxyCodeLine{01388\ \ \ \ \ \textcolor{comment}{//\ Sets\ a\ single\ foreground\ pixel}}
\DoxyCodeLine{01389\ \textcolor{preprocessor}{\#define\ SET\_FG\_PIXEL(pixel,color)\ \{\ \(\backslash\)}}
\DoxyCodeLine{01390\ \textcolor{preprocessor}{isize\ index\ =\ bufferoffset\ +\ pixel;\ \(\backslash\)}}
\DoxyCodeLine{01391\ \textcolor{preprocessor}{COLORIZE(index,color)\ \(\backslash\)}}
\DoxyCodeLine{01392\ \textcolor{preprocessor}{zBuffer[index]\ =\ DEPTH\_FG;\ \}}}
\DoxyCodeLine{01393\ }
\DoxyCodeLine{01394\ \ \ \ \ \textcolor{comment}{//\ Sets\ a\ single\ background\ pixel}}
\DoxyCodeLine{01395\ \textcolor{preprocessor}{\#define\ SET\_BG\_PIXEL(pixel,color)\ \{\ \(\backslash\)}}
\DoxyCodeLine{01396\ \textcolor{preprocessor}{isize\ index\ =\ bufferoffset\ +\ pixel;\ \(\backslash\)}}
\DoxyCodeLine{01397\ \textcolor{preprocessor}{COLORIZE(index,color)\ \(\backslash\)}}
\DoxyCodeLine{01398\ \textcolor{preprocessor}{zBuffer[index]\ =\ DEPTH\_BG;\ \}}}
\DoxyCodeLine{01399\ \ \ \ \ }
\DoxyCodeLine{01400\ \ \ \ \ \textcolor{comment}{//\ Sets\ a\ single\ sprite\ pixel}}
\DoxyCodeLine{01401\ \textcolor{preprocessor}{\#define\ SET\_SPRITE\_PIXEL(sprite,pixel,color)\ \{\ \(\backslash\)}}
\DoxyCodeLine{01402\ \textcolor{preprocessor}{isize\ index\ =\ bufferoffset\ +\ pixel;\ \(\backslash\)}}
\DoxyCodeLine{01403\ \textcolor{preprocessor}{if\ (u8\ depth\ =\ spriteDepth(sprite);\ depth\ <=\ zBuffer[index])\ \{\ \(\backslash\)}}
\DoxyCodeLine{01404\ \textcolor{preprocessor}{if\ (isVisibleColumn)\ COLORIZE(index,\ color);\ \(\backslash\)}}
\DoxyCodeLine{01405\ \textcolor{preprocessor}{zBuffer[index]\ =\ depth\ |\ (zBuffer[index]\ \&\ 0x10);\ \(\backslash\)}}
\DoxyCodeLine{01406\ \textcolor{preprocessor}{\}\ \}}}
\DoxyCodeLine{01407\ }
\DoxyCodeLine{01408\ \ \ \ \ }
\DoxyCodeLine{01409\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01410\ \ \ \ \ \textcolor{comment}{//\ Debugging}}
\DoxyCodeLine{01411\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01412\ }
\DoxyCodeLine{01413\ \textcolor{keyword}{public}:\ }
\DoxyCodeLine{01414\ }
\DoxyCodeLine{01415\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ current\ screen\ geometry}}
\DoxyCodeLine{01416\ \ \ \ \ \mbox{\hyperlink{_v_i_c_i_i_types_8h_a4b4722e29346b1d0c0c0faa810ec4c93}{ScreenGeometry}}\ getScreenGeometry(\textcolor{keywordtype}{void})\ \textcolor{keyword}{const};}
\DoxyCodeLine{01417\ \ \ \ \ }
\DoxyCodeLine{01418\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ coordinates\ of\ a\ certain\ sprite}}
\DoxyCodeLine{01419\ \ \ \ \ u16\ getSpriteX(\textcolor{keywordtype}{int}\ nr)\textcolor{keyword}{\ const\ }\{\ assert(nr\ <\ 8);\ \textcolor{keywordflow}{return}\ reg.current.sprX[nr];\ \}}
\DoxyCodeLine{01420\ \ \ \ \ u8\ getSpriteY(\textcolor{keywordtype}{int}\ nr)\textcolor{keyword}{\ const\ }\{\ assert(nr\ <\ 8);\ \textcolor{keywordflow}{return}\ reg.current.sprY[nr];\ \}}
\DoxyCodeLine{01421\ \};}
\DoxyCodeLine{01422\ }
\DoxyCodeLine{01423\ \}}

\end{DoxyCode}
