\doxysection{Cartridge.\+h}
\hypertarget{_cartridge_8h_source}{}\label{_cartridge_8h_source}\index{/Users/hoff/Retro/virtualc64/Emulator/Cartridges/Cartridge.h@{/Users/hoff/Retro/virtualc64/Emulator/Cartridges/Cartridge.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ VirtualC64}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ Dirk\ W.\ Hoffmann.\ www.dirkwhoffmann.de}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ This\ FILE\ is\ dual-\/licensed.\ You\ are\ free\ to\ choose\ between:}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ \ \ \ \ -\/\ The\ GNU\ General\ Public\ License\ v3\ (or\ any\ later\ version)}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ \ \ \ \ -\/\ The\ Mozilla\ Public\ License\ v2}}
\DoxyCodeLine{00009\ \textcolor{comment}{//}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ SPDX-\/License-\/Identifier:\ GPL-\/3.0-\/or-\/later\ OR\ MPL-\/2.0}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}CartridgeTypes.h"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}SubComponent.h"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}CartridgeRom.h"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}CRTFile.h"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{namespace\ }vc64\ \{}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{keyword}{class\ }Cartridge\ :\ \textcolor{keyword}{public}\ SubComponent,\ \textcolor{keyword}{public}\ Dumpable\ \{}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \ \ \ \ CartridgeTraits\ traits\ =\ \{}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ .type\ \ \ \ \ \ \ =\ CRT\_NORMAL,}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ .title\ \ \ \ \ \ =\ \textcolor{stringliteral}{"{}Cartridge"{}},}
\DoxyCodeLine{00028\ \ \ \ \ \};}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keyword}{const}\ CartridgeTraits\ \&getTraits()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ traits;\ \}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{comment}{//\ Maximum\ number\ of\ chip\ packets\ on\ a\ single\ cartridge}}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ isize\ MAX\_PACKETS\ =\ 128;}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{comment}{//\ Cartridge\ configuration}}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{/*\ Initial\ values\ of\ the\ game\ and\ exrom\ lines.\ The\ values\ are\ read\ from\ the}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ \ \ \ \ *\ CRT\ file\ and\ the\ game\ line\ is\ set\ to\ it\ when\ the\ cartridge\ is\ plugged}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ \ \ \ \ *\ into\ the\ expansion\ port.}}
\DoxyCodeLine{00050\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordtype}{bool}\ gameLineInCrtFile\ =\ 1;}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{bool}\ exromLineInCrtFile\ =\ 1;}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ Rom\ packets}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ isize\ numPackets\ =\ 0;}
\DoxyCodeLine{00062\ \ \ \ \ CartridgeRom\ *packet[MAX\_PACKETS]\ =\ \{\};}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{//\ Indicates\ which\ packets\ are\ currently\ mapped\ to\ ROML\ and\ ROMH}}
\DoxyCodeLine{00065\ \ \ \ \ isize\ chipL\ =\ 0;}
\DoxyCodeLine{00066\ \ \ \ \ isize\ chipH\ =\ 0;}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{comment}{/*\ Number\ of\ bytes\ that\ are\ mapped\ to\ ROML\ and\ ROMH.\ For\ most\ cartridges,}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ \ \ \ \ *\ this\ value\ is\ equals\ packet[romX]-\/>size\ which\ means\ that\ the\ ROM\ is}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ \ \ \ \ *\ completely\ mapped.\ A\ value\ of\ 0\ indicates\ that\ no\ ROM\ is\ currently}}
\DoxyCodeLine{00071\ \textcolor{comment}{\ \ \ \ \ *\ mapped.}}
\DoxyCodeLine{00072\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00073\ \ \ \ \ u16\ mappedBytesL\ =\ 0;}
\DoxyCodeLine{00074\ \ \ \ \ u16\ mappedBytesH\ =\ 0;}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{/*\ Offset\ into\ the\ ROM\ chip's\ data\ array.\ The\ first\ ROMx\ byte\ has\ index}}
\DoxyCodeLine{00077\ \textcolor{comment}{\ \ \ \ \ *\ offsetx.\ The\ last\ ROMx\ byte\ has\ index\ offsetx\ +\ mappedBytesx\ -\/\ 1.}}
\DoxyCodeLine{00078\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00079\ \ \ \ \ u16\ offsetL\ =\ 0;}
\DoxyCodeLine{00080\ \ \ \ \ u16\ offsetH\ =\ 0;}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{comment}{//\ On-\/board\ RAM}}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{//\ Additional\ RAM}}
\DoxyCodeLine{00089\ \ \ \ \ u8\ *externalRam\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{comment}{//\ RAM\ capacity\ in\ bytes}}
\DoxyCodeLine{00092\ \ \ \ \ isize\ ramCapacity\ =\ 0;}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{comment}{//\ Total\ number\ of\ write\ accesses}}
\DoxyCodeLine{00095\ \ \ \ \ i64\ writes\ =\ 0;}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{comment}{//\ On-\/board\ registers}}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{comment}{/*\ Auxililary\ control\ register.\ Many\ non-\/standard\ cartridges\ carry\ an}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ \ \ \ \ *\ additional\ register\ on\ board.}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00107\ \ \ \ \ u8\ control\ =\ 0;}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{comment}{//\ Hardware\ switches}}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{comment}{/*\ Current\ position\ of\ the\ cartridge\ switch\ (if\ any).\ Only\ a\ few\ cartridges}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ \ \ \ \ *\ have\ a\ switch\ such\ as\ ISEPIC\ and\ EXPERT.}}
\DoxyCodeLine{00118\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00119\ \ \ \ \ isize\ switchPos\ =\ 0;}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{comment}{//\ Status\ of\ the\ cartridge\ LED\ (true\ =\ on)}}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{bool}\ led\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{comment}{//\ Class\ methods}}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{comment}{//\ Checks\ whether\ this\ cartridge\ has\ a\ known\ type\ indentifier}}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ isKnownType(CartridgeType\ type);}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{comment}{//\ Checks\ whether\ this\ cartridge\ is\ a\ supported\ by\ the\ emulator}}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ isSupportedType(CartridgeType\ type);}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{comment}{//\ Returns\ true\ if\ addr\ is\ located\ in\ the\ ROML\ or\ the\ ROMH\ address\ space}}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ isROMLaddr(u16\ addr);}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ isROMHaddr(u16\ addr);}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{comment}{//\ Factory\ methods}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keyword}{static}\ Cartridge\ *makeWithType(C64\ \&c64,\ CartridgeType\ type)\ \textcolor{keywordflow}{throws};}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keyword}{static}\ Cartridge\ *makeWithCRTFile(C64\ \&c64,\ CRTFile\ \&file)\ \textcolor{keywordflow}{throws};}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ Initializing}}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ Cartridge(C64\ \&ref);}
\DoxyCodeLine{00153\ \ \ \ \ \string~Cartridge();}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{comment}{/*\ Resets\ the\ Game\ and\ the\ Exrom\ line.\ The\ default\ implementation\ resets}}
\DoxyCodeLine{00157\ \textcolor{comment}{\ \ \ \ \ *\ the\ values\ to\ ones\ found\ in\ the\ CRT\ file.\ A\ few\ custom\ cartridges\ need}}
\DoxyCodeLine{00158\ \textcolor{comment}{\ \ \ \ \ *\ other\ start\ configurations\ and\ overwrite\ this\ function.}}
\DoxyCodeLine{00159\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ resetCartConfig();}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keywordtype}{void}\ dealloc();}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{comment}{//\ Methods\ from\ CoreObject}}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *getDescription()\textcolor{keyword}{\ const\ override\ }\{\ \textcolor{keywordflow}{return}\ getTraits().title;\ \}}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordtype}{void}\ \_dump(Category\ category,\ std::ostream\&\ os)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{comment}{//\ Methods\ from\ CoreComponent}}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \ \ Cartridge\&\ operator=\ (\textcolor{keyword}{const}\ Cartridge\&\ other)\ \{}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Cloning\ cartridge\(\backslash\)n"{}});}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ cloneRomAndRam(other);}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ CLONE(chipL)}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ CLONE(chipH)}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ CLONE(mappedBytesL)}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ CLONE(mappedBytesH)}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ CLONE(offsetL)}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ CLONE(offsetH)}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ CLONE(led)}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ CLONE(gameLineInCrtFile)}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ CLONE(exromLineInCrtFile)}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ CLONE(numPackets)}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ CLONE(ramCapacity)}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ CLONE(writes)}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ CLONE(control)}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ CLONE(switchPos)}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00204\ \ \ \ \ \}}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keywordtype}{void}\ cloneRomAndRam(\textcolor{keyword}{const}\ Cartridge\&\ other);}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ clone(\textcolor{keyword}{const}\ Cartridge\ \&other)\ \{\ *\textcolor{keyword}{this}\ =\ other;\ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordtype}{void}\ serialize(T\&\ worker)}
\DoxyCodeLine{00210\ \ \ \ \ \{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ worker}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ <<\ chipL}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ <<\ chipH}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ <<\ mappedBytesL}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ <<\ mappedBytesH}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ <<\ offsetL}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ <<\ offsetH}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ <<\ led;}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isResetter(worker))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ worker}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ <<\ gameLineInCrtFile}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ <<\ exromLineInCrtFile}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ <<\ numPackets}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ <<\ ramCapacity}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ <<\ writes}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ <<\ control}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ <<\ switchPos;}
\DoxyCodeLine{00232\ \ \ \ \ \}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keywordtype}{void}\ operator\ <<\ (SerResetter\ \&worker)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordtype}{void}\ operator\ <<\ (SerChecker\ \&worker)\textcolor{keyword}{\ override\ }\{\ serialize(worker);\ \}}
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{keywordtype}{void}\ operator\ <<\ (SerCounter\ \&worker)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keywordtype}{void}\ operator\ <<\ (SerReader\ \&worker)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{keywordtype}{void}\ operator\ <<\ (SerWriter\ \&worker)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00244\ \ \ \ \ \textcolor{comment}{//\ Analyzing}}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \ \ CartridgeInfo\ getInfo()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00250\ \ \ \ \ CartridgeRomInfo\ getRomInfo(isize\ nr)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ cartridge\ type}}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keyword}{virtual}\ CartridgeType\ getCartridgeType()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getTraits().type;\ \}}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{comment}{//\ Checks\ whether\ this\ cartridge\ is\ supported\ by\ the\ emulator\ yet}}
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{keywordtype}{bool}\ isSupported()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ isSupportedType(getCartridgeType());\ \}}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{comment}{//\ Accessing}}
\DoxyCodeLine{00261\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ initial\ value\ of\ the\ Game\ or\ the\ Exrom\ line}}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ getGameLineInCrtFile()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ gameLineInCrtFile;\ \}}
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ getExromLineInCrtFile()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ exromLineInCrtFile;\ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{comment}{//\ Handling\ ROM\ packets}}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{comment}{//\ Reads\ in\ a\ chip\ packet\ from\ a\ CRT\ file}}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ loadChip(isize\ nr,\ \textcolor{keyword}{const}\ CRTFile\ \&c);}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ Banks\ in\ a\ rom\ chip\ into\ the\ ROML\ or\ the\ ROMH\ space}}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keywordtype}{void}\ bankInROML(isize\ nr,\ u16\ size,\ u16\ offset);}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keywordtype}{void}\ bankInROMH(isize\ nr,\ u16\ size,\ u16\ offset);}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{comment}{/*\ Banks\ in\ a\ rom\ chip.\ This\ function\ calls\ bankInROML\ or\ bankInROMH\ with}}
\DoxyCodeLine{00282\ \textcolor{comment}{\ \ \ \ \ *\ the\ default\ parameters\ for\ this\ chip\ as\ provided\ in\ the\ CRT\ file.}}
\DoxyCodeLine{00283\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ bankIn(isize\ nr);}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{comment}{//\ \ Banks\ out\ a\ chip\ (RAM\ will\ be\ visible\ again)}}
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{keywordtype}{void}\ bankOut(isize\ nr);}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00291\ \ \ \ \ \textcolor{comment}{//\ Accessing\ cartridge\ memory}}
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \textcolor{comment}{/*\ Fallthroughs\ for\ the\ cartridge\ memory}}
\DoxyCodeLine{00295\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00296\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ ROML\ range:\ 0x8000\ -\/\ 0x9FFF}}
\DoxyCodeLine{00297\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ ROMH\ range:\ 0xA000\ -\/\ 0xBFFF\ and\ 0xE000\ -\/\ 0xFFFF}}
\DoxyCodeLine{00298\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ peek(u16\ addr);}
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ peekRomL(u16\ addr);}
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ peekRomH(u16\ addr);}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ spypeek(u16\ addr)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ spypeekRomL(u16\ addr)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ spypeekRomH(u16\ addr)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ poke(u16\ addr,\ u8\ value);}
\DoxyCodeLine{00308\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ pokeRomL(u16\ addr,\ u8\ value)\ \{\ \textcolor{keywordflow}{return};\ \}}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ pokeRomH(u16\ addr,\ u8\ value)\ \{\ \textcolor{keywordflow}{return};\ \}}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{comment}{//\ Fallthroughs\ for\ the\ I/O\ spaces}}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ peekIO1(u16\ addr)\ \{\ \textcolor{keywordflow}{return}\ 0;\ \}}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ peekIO2(u16\ addr)\ \{\ \textcolor{keywordflow}{return}\ 0;\ \}}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ spypeekIO1(u16\ addr)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ 0;\ \}}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keyword}{virtual}\ u8\ spypeekIO2(u16\ addr)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ 0;\ \}}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ pokeIO1(u16\ addr,\ u8\ value)\ \{\ \}}
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ pokeIO2(u16\ addr,\ u8\ value)\ \{\ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{comment}{//\ Managing\ on-\/board\ RAM}}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ size\ of\ the\ on-\/board\ RAM\ in\ bytes}}
\DoxyCodeLine{00327\ \ \ \ \ isize\ getRamCapacity()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getTraits().memory;\ \}}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{comment}{/*\ Assigns\ external\ RAM\ to\ this\ cartridge.\ This\ functions\ frees\ any}}
\DoxyCodeLine{00330\ \textcolor{comment}{\ \ \ \ \ *\ previously\ assigned\ RAM\ and\ allocates\ memory\ of\ the\ specified\ size.\ The}}
\DoxyCodeLine{00331\ \textcolor{comment}{\ \ \ \ \ *\ size\ is\ stored\ in\ variable\ ramCapacity.}}
\DoxyCodeLine{00332\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keywordtype}{void}\ setRamCapacity(isize\ size);}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{comment}{//\ Reads\ or\ write\ RAM\ cells}}
\DoxyCodeLine{00336\ \ \ \ \ u8\ peekRAM(u32\ addr)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keywordtype}{void}\ pokeRAM(u32\ addr,\ u8\ value);}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keywordtype}{void}\ eraseRAM(u8\ value);}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{comment}{//\ Operating\ buttons}}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ number\ of\ available\ cartridge\ buttons}}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keyword}{virtual}\ isize\ numButtons()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ 0;\ \}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{comment}{/*\ Returns\ a\ textual\ description\ for\ a\ button\ or\ nullptr,\ if\ there\ is\ no}}
\DoxyCodeLine{00349\ \textcolor{comment}{\ \ \ \ \ *\ button\ with\ the\ specified\ number.}}
\DoxyCodeLine{00350\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *getButtonTitle(isize\ nr)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}};\ \}}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \ \ \ \ \textcolor{comment}{//\ Presses\ a\ button\ (make\ sure\ to\ call\ releaseButton()\ afterwards)}}
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ pressButton(isize\ nr)\ \{\ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{comment}{//\ Releases\ a\ button\ (make\ sure\ to\ call\ pressButton()\ before)}}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ releaseButton(isize\ nr)\ \{\ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{comment}{//\ Operating\ switches}}
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ current\ switch\ position}}
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{keyword}{virtual}\ isize\ getSwitch()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ switchPos;\ \}}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordtype}{bool}\ switchIsNeutral()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getSwitch()\ ==\ 0;\ \}}
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keywordtype}{bool}\ switchIsLeft()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getSwitch()\ <\ 0;\ \}}
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{keywordtype}{bool}\ switchIsRight()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getSwitch()\ >\ 0;\ \}}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{comment}{/*\ Returns\ a\ textual\ description\ for\ a\ switch\ position\ or\ nullptr\ if\ the}}
\DoxyCodeLine{00371\ \textcolor{comment}{\ \ \ \ \ *\ switch\ cannot\ be\ positioned\ this\ way.}}
\DoxyCodeLine{00372\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *getSwitchDescription(isize\ pos)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}};\ \}}
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *getSwitchDescription()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getSwitchDescription(getSwitch());\ \}}
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{keywordtype}{bool}\ validSwitchPosition(isize\ pos)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ getSwitchDescription(pos)\ !=\ \textcolor{keyword}{nullptr};\ \}}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{comment}{//\ Puts\ the\ switch\ in\ a\ certain\ position}}
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ setSwitch(isize\ pos);}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00382\ \ \ \ \ \textcolor{comment}{//\ Operating\ LEDs}}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \textcolor{comment}{//\ Returns\ true\ if\ the\ cartridge\ has\ a\ LED}}
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{comment}{//\ bool\ hasLED()\ const\ \{\ return\ traits.led;\ \}}}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{comment}{//\ Switches\ the\ LED\ on\ or\ off}}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ setLED(\textcolor{keywordtype}{bool}\ value)\ \{\ led\ =\ value;\ \}}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{comment}{//\ Handling\ delegation\ calls}}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{comment}{/*\ Emulator\ thread\ callback.\ This\ function\ is\ invoked\ by\ the\ expansion\ port.}}
\DoxyCodeLine{00397\ \textcolor{comment}{\ \ \ \ \ *\ Only\ a\ few\ cartridges\ such\ as\ EpyxFastLoader\ will\ do\ some\ action\ here.}}
\DoxyCodeLine{00398\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00399\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ execute()\ \{\ \};}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{comment}{//\ Modifies\ the\ memory\ source\ lookup\ tables\ if\ required}}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ updatePeekPokeLookupTables()\ \{\ \};}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \ \ \textcolor{comment}{//\ Called\ when\ the\ C64\ CPU\ is\ about\ to\ trigger\ an\ NMI}}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ nmiWillTrigger()\ \{\ \}}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00407\ \ \ \ \ \textcolor{comment}{//\ Called\ after\ the\ C64\ CPU\ has\ processed\ the\ NMI\ instruction}}
\DoxyCodeLine{00408\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ nmiDidTrigger()\ \{\ \}}
\DoxyCodeLine{00409\ \};}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \}}

\end{DoxyCode}
